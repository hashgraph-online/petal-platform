diff --git a/node_modules/@hashgraphonline/standards-sdk/dist/cjs/standards-sdk.cjs b/node_modules/@hashgraphonline/standards-sdk/dist/cjs/standards-sdk.cjs
index 340cd8f..e8c7b58 100644
--- a/node_modules/@hashgraphonline/standards-sdk/dist/cjs/standards-sdk.cjs
+++ b/node_modules/@hashgraphonline/standards-sdk/dist/cjs/standards-sdk.cjs
@@ -1,4 +1,4 @@
-"use strict";var _a5,_b2;Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const node_module=require("node:module"),util$b=require("util"),zod=require("zod"),sdk=require("@hashgraph/sdk"),axios$9=require("axios"),proto=require("@hashgraph/proto"),buffer$a=require("buffer"),ethers=require("ethers"),fileType=require("file-type"),Redis=require("ioredis"),mime=require("mime-types"),dateFns=require("date-fns"),crypto$1=require("crypto");var _documentCurrentScript="undefined"!=typeof document?document.currentScript:null;function _interopNamespaceDefault(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e)for(const i in e)if("default"!==i){const r=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:()=>e[i]})}return t.default=e,Object.freeze(t)}const mime__namespace=_interopNamespaceDefault(mime),require$1=node_module.createRequire("undefined"==typeof document?require("url").pathToFileURL(__filename).href:_documentCurrentScript&&"SCRIPT"===_documentCurrentScript.tagName.toUpperCase()&&_documentCurrentScript.src||new URL("standards-sdk.cjs",document.baseURI).href),accountModule=safeRequire("@hashgraph/sdk/lib/account/AccountId.cjs"),topicModule=safeRequire("@hashgraph/sdk/lib/topic/TopicCreateTransaction.cjs"),sdkModule=safeRequire("@hashgraph/sdk"),accountIdPattern=/^\d+\.\d+\.\d+$/u,prototypeMarker=Symbol.for("standards-sdk.topic-auto-renew.patch"),accountMarker=Symbol.for("standards-sdk.account-id.patch"),candidates=[];accountModule?.default&&topicModule?.default&&candidates.push({accountId:accountModule.default,topic:topicModule.default}),sdkModule&&candidates.push({accountId:sdkModule.AccountId??sdkModule.default?.AccountId,topic:sdkModule.TopicCreateTransaction??sdkModule.default?.TopicCreateTransaction});for(const t of candidates)patchTopicModule(t.topic,t.accountId);function safeRequire(e){try{return require$1(e)}catch{return null}}function patchTopicModule(e,t){if(!e||!t)return;patchAccountId(t);const i=e.prototype;if(Reflect.get(i,prototypeMarker))return;const r=i.setAutoRenewAccountId,n=i.freezeWith;i.setAutoRenewAccountId=function(e){const i=resolveAccountId(e,t);return i?(requireNotFrozen(this),this._autoRenewAccountId=i,this):r.call(this,e)},i.freezeWith=function(e){if(!this.getAutoRenewAccountId||"function"!=typeof this.getAutoRenewAccountId)return n.call(this,e);if(!this.getAutoRenewAccountId()){const i=this.transactionId?.accountId,r=e?.operatorAccountId,n=resolveAccountId(i,t)??resolveAccountId(r,t);n&&(this._autoRenewAccountId=n)}return n.call(this,e)},Reflect.set(i,prototypeMarker,!0)}function patchAccountId(e){if(Reflect.get(e,accountMarker))return;const t=e.fromString.bind(e);e.fromString=function(e){if("string"==typeof e)return t(e);const i=extractAccountIdString(e);if(i)return t(i);if(isProtoAccountId(e)){const i=toNumericString(e.shard),r=toNumericString(e.realm),n=toNumericString(e.num);if(i&&r&&n)return t(`${i}.${r}.${n}`)}return t(e)},Reflect.set(e,accountMarker,!0)}function resolveAccountId(e,t){if(e instanceof t)return e;if("string"==typeof e&&accountIdPattern.test(e))return t.fromString(e);const i=normalizeAutoRenewValue(e);return i?t.fromString(i):null}function normalizeAutoRenewValue(e){if("string"==typeof e&&accountIdPattern.test(e))return e;const t=extractAccountIdString(e);if(t)return t;if(isProtoAccountId(e)){const t=toNumericString(e.shard),i=toNumericString(e.realm),r=toNumericString(e.num);if(t&&i&&r){const e=`${t}.${i}.${r}`;if(accountIdPattern.test(e))return e}}return null}function extractAccountIdString(e){if("object"!=typeof e||null===e)return null;const t=e.toString;if("function"!=typeof t)return null;const i=t.call(e);return"string"!=typeof i?null:accountIdPattern.test(i)?i:null}function isProtoAccountId(e){if("object"!=typeof e||null===e)return!1;const t=e;return hasToString(t.shard)&&hasToString(t.realm)&&hasToString(t.num)}function hasToString(e){return"object"==typeof e&&null!==e&&"function"==typeof e.toString}function toNumericString(e){if("number"==typeof e&&Number.isFinite(e))return String(Math.trunc(e));if("bigint"==typeof e)return e.toString();if(hasToString(e)){const t=e.toString();if(/^\d+$/u.test(t))return t}return null}function requireNotFrozen(e){const t=e;t._requireNotFrozen?.()}Reflect.set(globalThis,"__standardsSdkTopicAutoRenewPatched",!0);let loggerFactory=null;function setLoggerFactory(e){loggerFactory=e,Logger$e.clearInstances()}let Logger$e=(_a5=class{constructor(e={}){if(loggerFactory)return loggerFactory(e);const t="undefined"!=typeof process&&"true"===process.env?.DISABLE_LOGS;this.silent=e.silent||t,this.level=this.silent?"silent":e.level||"info",this.moduleContext=e.module||"app",this.prettyPrint=!this.silent&&!1!==e.prettyPrint}static getInstance(e={}){const t=e.module||"default";if("undefined"!=typeof process&&"true"===process.env?.DISABLE_LOGS&&_a5.instances.has(t)){"silent"!==_a5.instances.get(t).getLevel()&&_a5.instances.delete(t)}if(!_a5.instances.has(t)){const i=loggerFactory?loggerFactory(e):new _a5(e);_a5.instances.set(t,i)}return _a5.instances.get(t)}setLogLevel(e){this.level=e}getLevel(){return this.level}setSilent(e){this.silent=e,e&&(this.level="silent")}setModule(e){this.moduleContext=e}formatArgs(e){if(0===e.length)return{msg:""};if(1===e.length)return"string"==typeof e[0]?{msg:e[0]}:{msg:"",data:e[0]};const t=[],i=[];e.forEach(e=>{"string"==typeof e||"number"==typeof e||"boolean"==typeof e?t.push(String(e)):i.push(e)});const r=t.join(" ");return i.length>0?{msg:r,data:i}:{msg:r}}shouldLog(e){if(this.silent||"silent"===this.level)return!1;const t=["trace","debug","info","warn","error","silent"],i=t.indexOf(this.level);return t.indexOf(e)>=i}getConsoleMethod(e){return"error"===e?console.error:"warn"===e?console.warn:"debug"===e?console.debug:console.log}writeLog(e,...t){if(!this.shouldLog(e))return;const{msg:i,data:r}=this.formatArgs(t),n=(new Date).toISOString(),o=this.getConsoleMethod(e);if(this.prettyPrint){let t=`${n} ${e.toUpperCase().padEnd(5)} [${this.moduleContext}] ${i}`;r&&(t+="\n"+util$b.inspect(r,{colors:!0,depth:3})),o(t)}else{const t={timestamp:n,level:e,module:this.moduleContext,message:i,...r&&{data:r}};o(JSON.stringify(t))}}debug(...e){this.writeLog("debug",...e)}info(...e){this.writeLog("info",...e)}warn(...e){this.writeLog("warn",...e)}error(...e){this.writeLog("error",...e)}trace(...e){this.writeLog("trace",...e)}static clearInstances(){_a5.instances.clear()}},_a5.instances=new Map,_a5);const sleep=e=>new Promise(t=>setTimeout(t,e));class HCS{constructor(){this.modelViewerLoaded=!1,this.modelViewerLoading=null,this.config={cdnUrl:"https://kiloscribe.com/api/inscription-cdn/",network:"mainnet",retryAttempts:3,retryBackoff:300,debug:!1,showLoadingIndicator:!1,loadingCallbackName:null},this.configMapping={hcsCdnUrl:"cdnUrl",hcsNetwork:"network",hcsRetryAttempts:"retryAttempts",hcsRetryBackoff:"retryBackoff",hcsDebug:"debug",hcsShowLoadingIndicator:"showLoadingIndicator",hcsLoadingCallbackName:"loadingCallbackName"},this.LoadedScripts={},this.LoadedWasm={},this.LoadedImages={},this.LoadedVideos={},this.LoadedAudios={},this.LoadedAudioUrls={},this.LoadedGLBs={},this.scriptLoadedEvent=new Event("HCSScriptLoaded"),this.loadQueue=[],this.isProcessingQueue=!1;try{this.logger=Logger$e.getInstance({module:"HCS-3",level:this.config.debug?"debug":"error"})}catch(e){this.logger=this.createFallbackLogger()}}createFallbackLogger(){return{debug:(...e)=>this.config.debug&&console.debug("[HCS-3]",...e),info:(...e)=>this.config.debug&&console.info("[HCS-3]",...e),warn:(...e)=>console.warn("[HCS-3]",...e),error:(...e)=>console.error("[HCS-3]",...e),setLogLevel:e=>{this.config.debug="debug"===e}}}log(...e){if(0===e.length)this.logger.debug("");else if(1===e.length)this.logger.debug(String(e[0]));else{const t=String(e[0]),i=e.slice(1);this.logger.debug(t,i)}}error(...e){if(0===e.length)this.logger.error("");else if(1===e.length)this.logger.error(String(e[0]));else{const t=String(e[0]),i=e.slice(1);this.logger.error(t,i)}}loadConfigFromHTML(){const e=document.querySelector("script[data-hcs-config]");e&&(Object.keys(this.configMapping).forEach(t=>{if(e.dataset[t]){const i=this.configMapping[t];let r=e.dataset[t];"true"===r&&(r=!0),"false"===r&&(r=!1),isNaN(Number(r))||""===r||(r=Number(r)),this.config[i]=r}}),this.logger.setLogLevel(this.config.debug?"debug":"error")),this.log("Loaded config:",this.config)}updateLoadingStatus(e,t){if("loaded"!==this.LoadedScripts[e]&&(this.config.showLoadingIndicator&&console.log("[HCS Loading] "+e+" : "+t),this.LoadedScripts[e]=t,this.config.loadingCallbackName&&"function"==typeof window[this.config.loadingCallbackName])){const i=window[this.config.loadingCallbackName];"function"==typeof i&&i(e,t)}}async fetchWithRetry(e,t=this.config.retryAttempts,i=this.config.retryBackoff){try{const t=await fetch(e);if(!t.ok)throw new Error("HTTP error! status: "+t.status);return t}catch(r){if(t>0)return this.log("Retrying fetch for "+e+" Attempts left: "+(t-1)),await this.sleep(i),this.fetchWithRetry(e,t-1,2*i);throw r}}sleep(e){return sleep(e)}isDuplicate(e){return!!this.LoadedScripts[e]}async retrieveHCS1Data(e,t=this.config.cdnUrl,i=this.config.network){const r=i.replace(/['"]+/g,""),n=await this.fetchWithRetry(t+e+"?network="+r);return await n.blob()}async loadScript(e){const t=e.getAttribute("data-src"),i=e.getAttribute("data-script-id"),r=t?.split("/").pop(),n=e.getAttribute("type"),o=e.hasAttribute("data-required"),a="module"===e.getAttribute("type");if(!this.isDuplicate(r||"")){this.updateLoadingStatus(i,"loading");try{const t=e.getAttribute("data-cdn-url")||this.config.cdnUrl,s=e.getAttribute("data-network")||this.config.network,c=await this.retrieveHCS1Data(r,t,s);if("wasm"===n){const t=await c.arrayBuffer(),r=await WebAssembly.compile(t);this.LoadedWasm[i]=await WebAssembly.instantiate(r,{env:{},...e.dataset}),this.updateLoadingStatus(i,"loaded"),window.dispatchEvent(this.scriptLoadedEvent),this.log("Loaded wasm: "+i)}else{const e=await c.text(),t=document.createElement("script");if(t.textContent=e,t.className="hcs-inline-script",i&&t.setAttribute("data-loaded-script-id",i),a){t.type="module";const i=new Blob([e],{type:"application/javascript"});t.src=URL.createObjectURL(i)}document.body.appendChild(t),this.updateLoadingStatus(i,"loaded"),window.dispatchEvent(this.scriptLoadedEvent),this.log("Loaded script: "+i),t.onerror=e=>{if(this.error("Failed to load "+n+": "+i,e),this.updateLoadingStatus(i,"failed"),o)throw e}}}catch(s){if(this.error("Failed to load "+n+": "+i,s),this.updateLoadingStatus(i,"failed"),o)throw s}}}async loadModuleExports(e){const t=document.querySelector('script[data-loaded-script-id="'+e+'"]');if(!t)throw new Error("Module script with id "+e+" not found");const i=t.getAttribute("src");if(!i)throw new Error("Module script "+e+" has no src attribute");try{const e=new Function("url","return import(url)");return await e(i)}catch(r){throw this.error("Failed to import module",r),r}}async loadStylesheet(e){const t=e.getAttribute("data-src"),i=e.getAttribute("data-script-id"),r=t?.split("/").pop(),n=e.hasAttribute("data-required");if(!this.isDuplicate(r||"")){this.updateLoadingStatus(i,"loading");try{const t=e.getAttribute("data-cdn-url")||this.config.cdnUrl,n=e.getAttribute("data-network")||this.config.network,o=await this.retrieveHCS1Data(r,t,n),a=await o.text(),s=document.createElement("style");s.textContent=a,document.head.appendChild(s),this.updateLoadingStatus(i,"loaded"),window.dispatchEvent(this.scriptLoadedEvent),this.log("Loaded and inlined stylesheet: "+i)}catch(o){if(this.error("Failed to load stylesheet: "+i,o),this.updateLoadingStatus(i,"failed"),n)throw o}}}async loadImage(e){const t=e.getAttribute("data-src"),i=t?.split("/").pop();this.log("Loading image: "+i),this.updateLoadingStatus("Image: "+i,"loaded");try{const t=e.getAttribute("data-cdn-url")||this.config.cdnUrl,r=e.getAttribute("data-network")||this.config.network,n=await this.retrieveHCS1Data(i,t,r),o=URL.createObjectURL(n);e.src=o,this.LoadedImages[i]=o,this.updateLoadingStatus("Image: "+i,"loaded"),this.log("Loaded image: "+i)}catch(r){this.error("Failed to load image: "+i,r),this.updateLoadingStatus("Image: "+i,"failed")}}async loadMedia(e,t){const i=e.getAttribute("data-src"),r=i?.split("/").pop();this.log("Loading "+t+": "+r),this.updateLoadingStatus(t+": "+r,"loading");try{const i=e.getAttribute("data-cdn-url")||this.config.cdnUrl,n=e.getAttribute("data-network")||this.config.network,o=await this.retrieveHCS1Data(r,i,n),a=URL.createObjectURL(o);e.src=a,"video"===t?this.LoadedVideos[r]=a:this.LoadedAudioUrls[r]=a,this.updateLoadingStatus(t+": "+r,"loaded"),this.log("Loaded "+t+": "+r)}catch(n){this.error("Failed to load "+t+": "+r,n),this.updateLoadingStatus(t+": "+r,"failed")}}async loadModelViewer(){return this.modelViewerLoading?this.modelViewerLoading:this.modelViewerLoaded?Promise.resolve():(this.modelViewerLoading=new Promise(e=>{const t=document.createElement("script");t.setAttribute("data-src","hcs://1/0.0.7293044"),t.setAttribute("data-script-id","model-viewer"),t.setAttribute("type","module"),window.addEventListener("HCSScriptLoaded",()=>{this.modelViewerLoaded=!0,e()},{once:!0}),this.loadScript(t)}),this.modelViewerLoading)}async loadGLB(e){await this.loadModelViewer();const t=e.getAttribute("data-src"),i=t?.split("/").pop();this.log("Loading GLB: "+i),this.updateLoadingStatus("GLB: "+i,"loading");try{const t=e.getAttribute("data-cdn-url")||this.config.cdnUrl,r=e.getAttribute("data-network")||this.config.network;let n;"model-viewer"!==e.tagName.toLowerCase()?(n=document.createElement("model-viewer"),Array.from(e.attributes).forEach(e=>{n.setAttribute(e.name,e.value)}),n.setAttribute("camera-controls",""),n.setAttribute("auto-rotate",""),n.setAttribute("ar",""),e.parentNode?.replaceChild(n,e)):n=e;const o=await this.retrieveHCS1Data(i,t,r),a=URL.createObjectURL(o);n.setAttribute("src",a),this.LoadedGLBs[i]=a,this.updateLoadingStatus("GLB: "+i,"loaded"),this.log("Loaded GLB: "+i)}catch(r){this.error("Failed to load GLB: "+i,r),this.updateLoadingStatus("GLB: "+i,"failed")}}async loadResource(e,t,i){return new Promise(r=>{this.loadQueue.push({element:e,type:t,order:i,resolve:r}),this.processQueue()})}async processQueue(){if(!this.isProcessingQueue){for(this.isProcessingQueue=!0;this.loadQueue.length>0;){const t=this.loadQueue.shift();try{"script"===t.type?await this.loadScript(t.element):"image"===t.type?await this.loadImage(t.element):"video"===t.type||"audio"===t.type?await this.loadMedia(t.element,t.type):"glb"===t.type?await this.loadGLB(t.element):"css"===t.type&&await this.loadStylesheet(t.element),t.resolve()}catch(e){if(this.error("Error processing queue item:",e),"script"===t.type&&t.element.hasAttribute("data-required"))break}}this.isProcessingQueue=!1}}async replaceHCSInStyle(e){let t=e,i=t.indexOf("hcs://");for(;-1!==i;){let e=i;for(;e<t.length&&!["'",'"'," ",")"].includes(t[e]);)e++;const n=t.substring(i,e),o=n.split("/").pop();try{const r=this.config.cdnUrl,a=this.config.network,s=await this.retrieveHCS1Data(o,r,a),c=URL.createObjectURL(s);t=t.substring(0,i)+c+t.substring(e),this.LoadedImages[o]=c,this.log("Replaced CSS HCS URL: "+n+" with "+c)}catch(r){this.error("Failed to load CSS image: "+o,r)}i=t.indexOf("hcs://",i+1)}return t}async processInlineStyles(){const e=document.querySelectorAll('[style*="hcs://"]');this.log("Found "+e.length+" elements with HCS style references");for(const i of Array.from(e)){const e=i.getAttribute("style");if(e){this.log("Processing style: "+e);const t=await this.replaceHCSInStyle(e);e!==t&&(i.setAttribute("style",t),this.log("Updated style to: "+t))}}const t=document.querySelectorAll("style");for(const i of Array.from(t))if(i.textContent?.includes("hcs://")){const e=await this.replaceHCSInStyle(i.textContent);i.textContent!==e&&(i.textContent=e)}}async init(){return this.loadConfigFromHTML(),new Promise(e=>{const t=async()=>{const t=document.querySelectorAll('script[data-src^="hcs://"]'),i=document.querySelectorAll('img[data-src^="hcs://"], img[src^="hcs://"]'),r=document.querySelectorAll('video[data-src^="hcs://"], video[src^="hcs://"]'),n=document.querySelectorAll('audio[data-src^="hcs://"], audio[src^="hcs://"]'),o=document.querySelectorAll('model-viewer[data-src^="hcs://"]'),a=document.querySelectorAll('link[data-src^="hcs://"]');document.querySelectorAll('[src^="hcs://"]').forEach(e=>{const t=e.getAttribute("src");t&&(e.setAttribute("data-src",t),e.removeAttribute("src"))}),await this.processInlineStyles();const s=[];[{elements:t,type:"script"},{elements:i,type:"image"},{elements:r,type:"video"},{elements:n,type:"audio"},{elements:o,type:"glb"},{elements:a,type:"css"}].forEach(({elements:e,type:t})=>{e.forEach(e=>{const i=parseInt(e.getAttribute("data-load-order")||"")||1/0;s.push(this.loadResource(e,t,i))})}),await Promise.all(s);const c=new MutationObserver(e=>{e.forEach(e=>{if(e.addedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){const t=e;if(t.getAttribute("style")?.includes("hcs://")&&this.processInlineStyles(),"style"===t.tagName.toLowerCase()&&t.textContent?.includes("hcs://")&&this.processInlineStyles(),t.getAttribute("src")?.startsWith("hcs://")){const e=t.getAttribute("src");t.setAttribute("data-src",e),t.removeAttribute("src");switch(t.tagName.toLowerCase()){case"img":this.loadResource(t,"image",1/0);break;case"video":this.loadResource(t,"video",1/0);break;case"audio":this.loadResource(t,"audio",1/0);break;case"script":this.loadResource(t,"script",1/0)}}t.matches('script[data-src^="hcs://"]')?this.loadResource(t,"script",1/0):t.matches('img[data-src^="hcs://"]')?this.loadResource(t,"image",1/0):t.matches('video[data-src^="hcs://"]')?this.loadResource(t,"video",1/0):t.matches('audio[data-src^="hcs://"]')?this.loadResource(t,"audio",1/0):t.matches('model-viewer[data-src^="hcs://"]')?this.loadResource(t,"glb",1/0):t.matches('link[data-src^="hcs://"]')&&this.loadResource(t,"css",1/0);t.querySelectorAll('[data-src^="hcs://"], [src^="hcs://"]').forEach(e=>{const t=e,i=t.tagName.toLowerCase(),r=t.getAttribute("src");switch(r?.startsWith("hcs://")&&(t.setAttribute("data-src",r),t.removeAttribute("src")),i){case"script":this.loadResource(t,"script",1/0);break;case"img":this.loadResource(t,"image",1/0);break;case"video":this.loadResource(t,"video",1/0);break;case"audio":this.loadResource(t,"audio",1/0);break;case"model-viewer":this.loadResource(t,"glb",1/0);break;case"link":this.loadResource(t,"css",1/0)}})}}),"attributes"===e.type){const t=e.target;if("style"===e.attributeName&&t.getAttribute("style")?.includes("hcs://"))this.processInlineStyles();else if("src"===e.attributeName){const e=t.getAttribute("src");if(e?.startsWith("hcs://")){t.setAttribute("data-src",e),t.removeAttribute("src");const i=t.tagName.toLowerCase();["img","video","audio"].includes(i)&&this.loadResource(t,i,1/0)}}}})});document.body?c.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","src","data-src"]}):document.addEventListener("DOMContentLoaded",()=>{c.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","src","data-src"]})}),e()};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()})}async preloadImage(e){this.log("Loading image:"+e),this.updateLoadingStatus("image: "+e,"loading");const t=await this.retrieveHCS1Data(e),i=URL.createObjectURL(t);return this.LoadedImages[e]=i,this.updateLoadingStatus("image: "+e,"loaded"),i}async preloadAudio(e){const t=document.createElement("audio");t.setAttribute("data-topic-id",e),t.setAttribute("data-src","hcs://1/"+e),document.body.appendChild(t),await this.loadMedia(t,"audio");const i=document.querySelector('audio[data-topic-id="'+e+'"]');return i?this.LoadedAudioUrls[e]=i.src:console.error("Failed to preload audio: "+e),this.LoadedAudioUrls[e]}async playAudio(e,t=1){const i=this.LoadedAudioUrls[e];if(i){const r=new Audio(i);r.volume=t,this.LoadedAudios[e]=r,r.play().catch(e=>{console.error("Failed to play audio:",e)}),r.addEventListener("ended",()=>{r.remove(),delete this.LoadedAudios[e]})}else console.error("Audio not preloaded: "+e)}async pauseAudio(e){const t=document.querySelector('audio[data-topic-id="'+e+'"]');t?(console.log("found element",t),t.pause(),this.LoadedAudios[e]?.pause()):this.LoadedAudios[e]?.pause()}async loadAndPlayAudio(e,t=!1,i=1){let r=document.querySelector('audio[data-topic-id="'+e+'"]');if(r)r.volume=i,await r.play();else{const n=document.createElement("audio");n.volume=i,t&&n.setAttribute("autoplay","autoplay"),n.setAttribute("data-topic-id",e),n.setAttribute("data-src","hcs://1/"+e),document.body.appendChild(n),await this.loadMedia(n,"audio"),r=document.querySelector('audio[data-topic-id="'+e+'"]'),t||await r.play()}}}var HCS6Operation=(e=>(e.REGISTER="register",e))(HCS6Operation||{}),HCS6RegistryType=(e=>(e[e.NON_INDEXED=1]="NON_INDEXED",e))(HCS6RegistryType||{});function buildHcs6Hrl(e){return`hcs://6/${e}`}const hcs6TopicIdSchema$2=zod.z.string().regex(/^\d+\.\d+\.\d+$/,{message:"Topic ID must be in Hedera format (e.g., '0.0.123456')"}),hcs6BaseMessageSchema$2=zod.z.object({p:zod.z.literal("hcs-6"),op:zod.z.enum(["register"]),m:zod.z.string().max(500,"Memo must not exceed 500 characters").optional()}),hcs6RegisterMessageSchema$2=hcs6BaseMessageSchema$2.extend({op:zod.z.literal("register"),t_id:hcs6TopicIdSchema$2}),hcs6MessageSchema=zod.z.discriminatedUnion("op",[hcs6RegisterMessageSchema$2]);function validateHCS6TTL(e){return e>=3600}function validateHCS6RegistryMemo(e){const t=e.match(/^hcs-6:(\d):(\d+)$/);if(!t)return!1;const i=parseInt(t[1]),r=parseInt(t[2]);return 1===i&&validateHCS6TTL(r)}function generateHCS6RegistryMemo(e){if(!validateHCS6TTL(e))throw new Error("TTL must be at least 3600 seconds (1 hour)");return`hcs-6:1:${e}`}let HederaMirrorNode$3=class{constructor(e,t,i){this.maxRetries=5,this.initialDelayMs=2e3,this.maxDelayMs=3e4,this.backoffFactor=2,this.network=e,this.apiKey=i?.apiKey,this.customHeaders=i?.headers||{},this.baseUrl=i?.customUrl||this.getMirrorNodeUrl(),this.logger=t||new Logger$e({level:"debug",module:"MirrorNode"}),this.isServerEnvironment="undefined"==typeof window,i?.customUrl&&this.logger.info(`Using custom mirror node URL: ${i.customUrl}`),i?.apiKey&&this.logger.info("Using API key for mirror node requests")}configureRetry(e){this.maxRetries=e.maxRetries??this.maxRetries,this.initialDelayMs=e.initialDelayMs??this.initialDelayMs,this.maxDelayMs=e.maxDelayMs??this.maxDelayMs,this.backoffFactor=e.backoffFactor??this.backoffFactor,this.logger.info(`Retry configuration updated: maxRetries=${this.maxRetries}, initialDelayMs=${this.initialDelayMs}, maxDelayMs=${this.maxDelayMs}, backoffFactor=${this.backoffFactor}`)}configureMirrorNode(e){e.customUrl&&(this.baseUrl=e.customUrl,this.logger.info(`Updated mirror node URL: ${e.customUrl}`)),e.apiKey&&(this.apiKey=e.apiKey,this.logger.info("Updated API key for mirror node requests")),e.headers&&(this.customHeaders={...this.customHeaders,...e.headers},this.logger.info("Updated custom headers for mirror node requests"))}constructUrl(e){if(this.baseUrl.includes("<API-KEY>")&&this.apiKey){const t=this.baseUrl.replace("<API-KEY>",this.apiKey);return e.startsWith("/")?`${t}${e}`:`${t}/${e}`}return e.startsWith("/")?`${this.baseUrl}${e}`:`${this.baseUrl}/${e}`}getMirrorNodeUrl(){return"mainnet"===this.network?"https://mainnet-public.mirrornode.hedera.com":"https://testnet.mirrornode.hedera.com"}getBaseUrl(){return this.baseUrl}async getPublicKey(e){this.logger.debug(`Getting public key for account ${e}`);const t=await this.requestAccount(e);try{if(!t||!t.key)throw new Error(`Failed to retrieve public key for account ID: ${e}`);return sdk.PublicKey.fromString(t.key.key)}catch(i){const e=`Error fetching public key from Mirror Node: ${i.message}`;throw this.logger.error(e),new Error(e)}}async getAccountMemo(e){this.logger.debug(`Getting account memo for account ID: ${e}`);try{const t=await this._requestWithRetry(`/api/v1/accounts/${e}`);return t?.memo?t.memo:(this.logger.warn(`No memo found for account ${e}`),null)}catch(t){const i=t;return this.logger.error(`Failed to get account memo for ${e} after retries: ${i.message}`),null}}async getTopicInfo(e){try{this.logger.debug(`Fetching topic info for ${e}`);return await this._requestWithRetry(`/api/v1/topics/${e}`)}catch(t){const i=`Error retrieving topic information for ${e} after retries: ${t.message}`;throw this.logger.error(i),new Error(i)}}async getTopicFees(e){try{return(await this.getTopicInfo(e)).custom_fees}catch(t){const e=`Error retrieving topic fees: ${t.message}`;return this.logger.error(e),null}}async getHBARPrice(e){try{const t=sdk.Timestamp.fromDate(e).toString();this.logger.debug(`Fetching HBAR price for timestamp ${t}`);const i=await this._requestWithRetry(`/api/v1/network/exchangerate?timestamp=${t}`);return Number(i?.current_rate?.cent_equivalent)/Number(i?.current_rate?.hbar_equivalent)/100}catch(t){const e=`Error retrieving HBAR price: ${t.message}`;return this.logger.error(e),null}}async getTokenInfo(e){this.logger.debug(`Fetching token info for ${e}`);try{const t=await this._requestWithRetry(`/api/v1/tokens/${e}`);return t?(this.logger.trace(`Token info found for ${e}:`,t),t):(this.logger.warn(`No token info found for ${e}`),null)}catch(t){const i=`Error fetching token info for ${e}: ${t.message}`;return this.logger.error(i),null}}async getTopicMessages(e,t){this.logger.trace(`Querying messages for topic ${e}${t?" with filters":""}`);let i=`/api/v1/topics/${e}/messages`;const r=new URLSearchParams;if(t){if(void 0!==t.sequenceNumber){const e="number"==typeof t.sequenceNumber?t.sequenceNumber.toString():t.sequenceNumber;e.match(/^(gt|gte|lt|lte|eq|ne):/)?r.append("sequencenumber",e):r.append("sequencenumber",`gt:${e}`)}t.limit&&r.append("limit",t.limit.toString()),t.order&&r.append("order",t.order)}const n=r.toString();n&&(i+=`?${n}`);const o=[];let a=i;for(;a;)try{const e=await this._requestWithRetry(a);if(e.messages&&e.messages.length>0)for(const t of e.messages)try{if(!t.message)continue;let e,i;try{e=this.isServerEnvironment?globalThis.Buffer.from(t.message,"base64").toString("utf-8"):(new TextDecoder).decode(Uint8Array.from(atob(t.message),e=>e.charCodeAt(0)))}catch(s){const e=`Error decoding message: ${s}`;this.logger.error(e);continue}try{i=JSON.parse(e)}catch(s){const t=`Invalid JSON message content: ${e}`;this.logger.error(t);continue}i.sequence_number=t.sequence_number,o.push({...i,consensus_timestamp:t.consensus_timestamp,sequence_number:t.sequence_number,running_hash:t.running_hash,running_hash_version:t.running_hash_version,topic_id:t.topic_id,payer:t.payer_account_id,created:new Date(1e3*Number(t.consensus_timestamp))})}catch(s){const e=`Error processing message: ${s.message}`;this.logger.error(e)}a=e.links?.next||""}catch(c){const t=`Error querying topic messages for topic ${e} (endpoint: ${a}) after retries: ${c.message}`;throw this.logger.error(t),new Error(t)}return o}async requestAccount(e){try{this.logger.debug(`Requesting account info for ${e}`);const t=await this._requestWithRetry(`/api/v1/accounts/${e}`);if(!t)throw new Error(`No data received from mirror node for account: ${e}`);return t}catch(t){const i=`Failed to fetch account ${e} after retries: ${t.message}`;throw this.logger.error(i),new Error(i)}}async checkKeyListAccess(e,t){try{const i=proto.proto.Key.decode(e);return this.evaluateKeyAccess(i,t)}catch(i){const e=`Error decoding protobuf key: ${i.message}`;throw this.logger.error(e),new Error(e)}}async evaluateKeyAccess(e,t){return e.ed25519?this.compareEd25519Key(e.ed25519,t):e.keyList?this.evaluateKeyList(e.keyList,t):!(!e.thresholdKey||!e.thresholdKey.keys)&&this.evaluateKeyList(e.thresholdKey.keys,t)}async evaluateKeyList(e,t){const i=e.keys||[];for(const n of i)if(n)if(n.ed25519){if(this.compareEd25519Key(n.ed25519,t))return!0}else if(n.keyList||n.thresholdKey)try{const e=proto.proto.Key.encode({...n.keyList?{keyList:n.keyList}:{},...n.thresholdKey?{thresholdKey:n.thresholdKey}:{}}).finish();if(await this.checkKeyListAccess(globalThis.Buffer.from(e),t))return!0}catch(r){const e=`Error in nested key: ${r.message}`;this.logger.debug(e)}return!1}compareEd25519Key(e,t){try{return sdk.PublicKey.fromBytes(globalThis.Buffer.from(e)).toString()===t.toString()}catch(i){const e=`Error comparing Ed25519 key: ${i.message}`;return this.logger.debug(e),!1}}async getScheduleInfo(e){try{this.logger.info(`Getting information for scheduled transaction ${e}`);const t=await this._requestWithRetry(`/api/v1/schedules/${e}`);return t||(this.logger.warn(`No schedule info found for ${e} after retries.`),null)}catch(t){return this.logger.error(`Error fetching schedule info for ${e} after retries: ${t.message}`),null}}async getScheduledTransactionStatus(e){try{this.logger.info(`Checking status of scheduled transaction ${e}`);const t=await this.getScheduleInfo(e);if(!t)throw new Error(`Schedule ${e} not found`);return{executed:Boolean(t.executed_timestamp),executedDate:t.executed_timestamp?new Date(1e3*Number(t.executed_timestamp)):void 0,deleted:t.deleted||!1}}catch(t){throw this.logger.error(`Error checking scheduled transaction status: ${t}`),t}}async getTransaction(e){this.logger.info(`Getting transaction details for ID/hash: ${e}`);try{const t=await this._requestWithRetry(`/api/v1/transactions/${e}`);return t?.transactions?.length>0?(this.logger.trace(`Transaction details found for ${e}:`,t.transactions[0]),t.transactions[0]):(this.logger.warn(`No transaction details found for ${e} or unexpected response structure.`),null)}catch(t){const i=t;return this.logger.error(`Failed to get transaction details for ${e} after retries: ${i.message}`),null}}async _requestWithRetry(e,t){let i=0,r=this.initialDelayMs;const n=this.constructUrl(e),o={...t,headers:{...this.customHeaders,...t?.headers}};for(this.apiKey&&(o.headers={...o.headers,Authorization:`Bearer ${this.apiKey}`,"X-API-Key":this.apiKey});i<this.maxRetries;)try{return(await axios$9.get(n,o)).data}catch(a){i++;const e=i>=this.maxRetries,t=a.response?.status;if(t&&t>404&&t<500&&429!==t)throw this.logger.error(`Client error for ${n} (status ${t}): ${a.message}. Not retrying.`),a;if(e)throw this.logger.error(`Max retries (${this.maxRetries}) reached for ${n}. Last error: ${a.message}`),a;this.logger.warn(`Attempt ${i}/${this.maxRetries} failed for ${n}: ${a.message}. Retrying in ${r}ms...`),await new Promise(e=>setTimeout(e,r)),r=Math.min(r*this.backoffFactor,this.maxDelayMs)}throw new Error(`Failed to fetch data from ${n} after ${this.maxRetries} attempts.`)}async _fetchWithRetry(e,t){let i=0,r=this.initialDelayMs;const n={...this.customHeaders};t?.headers&&(t.headers instanceof Headers?t.headers.forEach((e,t)=>{n[t]=e}):Array.isArray(t.headers)?t.headers.forEach(([e,t])=>{n[e]=t}):Object.assign(n,t.headers)),this.apiKey&&(n.Authorization=`Bearer ${this.apiKey}`,n["X-API-Key"]=this.apiKey);const o={...t,headers:n};for(;i<this.maxRetries;)try{const t=await fetch(e,o);if(!t.ok){if(t.status>=400&&t.status<500&&429!==t.status)throw this.logger.error(`Client error for ${e} (status ${t.status}): ${t.statusText}. Not retrying.`),new Error(`Fetch failed with status ${t.status}: ${t.statusText} for URL: ${e}`);throw new Error(`Fetch failed with status ${t.status}: ${t.statusText} for URL: ${e}`)}return await t.json()}catch(a){if(i++,i>=this.maxRetries)throw this.logger.error(`Max retries (${this.maxRetries}) reached for ${e}. Last error: ${a.message}`),a;this.logger.warn(`Attempt ${i}/${this.maxRetries} failed for ${e}: ${a.message}. Retrying in ${r}ms...`),await new Promise(e=>setTimeout(e,r)),r=Math.min(r*this.backoffFactor,this.maxDelayMs)}throw new Error(`Failed to fetch data from ${e} after ${this.maxRetries} attempts.`)}async getAccountBalance(e){this.logger.info(`Getting balance for account ${e}`);try{const t=await this.requestAccount(e);if(t&&t.balance){return t.balance.balance/1e8}return this.logger.warn(`Could not retrieve balance for account ${e} from account info.`),null}catch(t){return this.logger.error(`Error fetching numerical balance for account ${e}: ${t.message}`),null}}async getTopicMessagesByFilter(e,t){this.logger.trace(`Querying messages for topic ${e} with filters: ${JSON.stringify(t)}`);let i=`/api/v1/topics/${e}/messages`;const r=new URLSearchParams;t?.limit&&r.append("limit",t.limit.toString()),t?.sequenceNumber&&r.append("sequencenumber",t.sequenceNumber),t?.startTime&&r.append("timestamp",`gte:${t.startTime}`),t?.endTime&&r.append("timestamp",`lt:${t.endTime}`),t?.order&&r.append("order",t.order);const n=r.toString();n&&(i+=`?${n}`);const o=[];let a=0;try{for(;i&&a<10;){a++;const e=await this._requestWithRetry(i);if(e.messages&&e.messages.length>0)for(const t of e.messages)try{if(!t.message)continue;let e;e=this.isServerEnvironment?globalThis.Buffer.from(t.message,"base64").toString("utf-8"):(new TextDecoder).decode(Uint8Array.from(atob(t.message),e=>e.charCodeAt(0)));let i={};try{i=JSON.parse(e)}catch(s){this.logger.debug(`Message content is not valid JSON, using raw: ${e}`),i={raw_content:e}}const r={...i,consensus_timestamp:t.consensus_timestamp,sequence_number:t.sequence_number,payer_account_id:t.payer_account_id,topic_id:t.topic_id,running_hash:t.running_hash,running_hash_version:t.running_hash_version,chunk_info:t.chunk_info,created:new Date(1e3*Number(t.consensus_timestamp.split(".")[0])+Number(t.consensus_timestamp.split(".")[1]||0)/1e6),payer:t.payer_account_id};o.push(r)}catch(c){this.logger.error(`Error processing individual message: ${c.message}`)}if(t?.limit&&o.length>=t.limit)break;i=e.links?.next?`${e.links.next}`:""}return o}catch(u){const t=u;return this.logger.error(`Error querying filtered topic messages for ${e}: ${t.message}`),null}}async getAccountTokens(e,t=100){this.logger.info(`Getting tokens for account ${e}`);let i=[],r=`/api/v1/accounts/${e}/tokens?limit=${t}`;try{for(let e=0;e<10&&r;e++){const e=await this._requestWithRetry(r);if(e&&e.tokens&&(i=i.concat(e.tokens)),r=e.links?.next||"",!r||t&&i.length>=t){t&&i.length>t&&(i=i.slice(0,t));break}}return i}catch(n){return this.logger.error(`Error fetching tokens for account ${e}: ${n.message}`),null}}async getTransactionByTimestamp(e){this.logger.info(`Getting transaction by timestamp: ${e}`);try{return(await this._requestWithRetry(`/api/v1/transactions?timestamp=${e}&limit=1`)).transactions}catch(t){return this.logger.error(`Error fetching transaction by timestamp ${e}: ${t}`),[]}}async getAccountNfts(e,t,i=100){this.logger.info(`Getting NFTs for account ${e}${t?` for token ${t}`:""}`);let r=[],n=`/api/v1/accounts/${e}/nfts?limit=${i}`;t&&(n+=`&token.id=${t}`);try{for(let e=0;e<10&&n;e++){const e=await this._requestWithRetry(n);if(e&&e.nfts){const t=e.nfts.map(e=>{let t;if(e.metadata)try{t=this.isServerEnvironment?globalThis.Buffer.from(e.metadata,"base64").toString("utf-8"):(new TextDecoder).decode(Uint8Array.from(atob(e.metadata),e=>e.charCodeAt(0)))}catch(i){this.logger.warn(`Failed to decode metadata for NFT ${e.token_id} SN ${e.serial_number}: ${i.message}`)}return{...e,token_uri:t}});r=r.concat(t)}if(n=e.links?.next||"",!n)break}return r}catch(o){return this.logger.error(`Error fetching NFTs for account ${e}: ${o.message}`),null}}async validateNFTOwnership(e,t,i){this.logger.info(`Validating ownership of NFT ${t} SN ${i} for account ${e}`);try{const r=await this.getAccountNfts(e,t);if(r){return r.find(e=>e.token_id===t&&e.serial_number===i)||null}return null}catch(r){return this.logger.error(`Error validating NFT ownership: ${r.message}`),null}}async readSmartContractQuery(e,t,i,r){this.logger.info(`Reading smart contract ${e} with selector ${t}`);const n=e.startsWith("0x")?e:`0x${sdk.AccountId.fromString(e).toSolidityAddress()}`,o=i.startsWith("0x")?i:`0x${sdk.AccountId.fromString(i).toSolidityAddress()}`,a={block:r?.block||"latest",data:t,estimate:r?.estimate||!1,from:o,to:n,gas:r?.gas,gasPrice:r?.gasPrice,value:r?.value||0};Object.keys(a).forEach(e=>{const t=e;void 0===a[t]&&delete a[t]});try{const e=this.constructUrl("/api/v1/contracts/call");return await this._fetchWithRetry(e,{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}})}catch(s){return this.logger.error(`Error reading smart contract ${e}: ${s.message}`),null}}async getOutstandingTokenAirdrops(e,t){this.logger.info(`Getting outstanding token airdrops sent by account ${e}`);let i=`/api/v1/accounts/${e}/airdrops/outstanding`;const r=new URLSearchParams;t?.limit&&r.append("limit",t.limit.toString()),t?.order&&r.append("order",t.order),t?.receiverId&&r.append("receiver.id",t.receiverId),t?.serialNumber&&r.append("serialnumber",t.serialNumber),t?.tokenId&&r.append("token.id",t.tokenId);const n=r.toString();n&&(i+=`?${n}`);try{return(await this._requestWithRetry(i)).airdrops||[]}catch(o){return this.logger.error(`Error fetching outstanding token airdrops for account ${e}: ${o.message}`),null}}async getPendingTokenAirdrops(e,t){this.logger.info(`Getting pending token airdrops received by account ${e}`);let i=`/api/v1/accounts/${e}/airdrops/pending`;const r=new URLSearchParams;t?.limit&&r.append("limit",t.limit.toString()),t?.order&&r.append("order",t.order),t?.senderId&&r.append("sender.id",t.senderId),t?.serialNumber&&r.append("serialnumber",t.serialNumber),t?.tokenId&&r.append("token.id",t.tokenId);const n=r.toString();n&&(i+=`?${n}`);try{return(await this._requestWithRetry(i)).airdrops||[]}catch(o){return this.logger.error(`Error fetching pending token airdrops for account ${e}: ${o.message}`),null}}async getBlocks(e){this.logger.info("Getting blocks from the network");let t="/api/v1/blocks";const i=new URLSearchParams;e?.limit&&i.append("limit",e.limit.toString()),e?.order&&i.append("order",e.order),e?.timestamp&&i.append("timestamp",e.timestamp),e?.blockNumber&&i.append("block.number",e.blockNumber);const r=i.toString();r&&(t+=`?${r}`);try{return(await this._requestWithRetry(t)).blocks||[]}catch(n){return this.logger.error(`Error fetching blocks: ${n.message}`),null}}async getBlock(e){this.logger.info(`Getting block ${e}`);try{return await this._requestWithRetry(`/api/v1/blocks/${e}`)}catch(t){return this.logger.error(`Error fetching block ${e}: ${t.message}`),null}}async getContracts(e){this.logger.info("Getting contracts from the network");let t="/api/v1/contracts";const i=new URLSearchParams;e?.contractId&&i.append("contract.id",e.contractId),e?.limit&&i.append("limit",e.limit.toString()),e?.order&&i.append("order",e.order);const r=i.toString();r&&(t+=`?${r}`);try{return(await this._requestWithRetry(t)).contracts||[]}catch(n){return this.logger.error(`Error fetching contracts: ${n.message}`),null}}async getContract(e,t){this.logger.info(`Getting contract ${e}`);let i=`/api/v1/contracts/${e}`;t&&(i+=`?timestamp=${t}`);try{return await this._requestWithRetry(i)}catch(r){return this.logger.error(`Error fetching contract ${e}: ${r.message}`),null}}async getContractResults(e){this.logger.info("Getting contract results from the network");let t="/api/v1/contracts/results";const i=new URLSearchParams;e?.from&&i.append("from",e.from),e?.blockHash&&i.append("block.hash",e.blockHash),e?.blockNumber&&i.append("block.number",e.blockNumber),void 0!==e?.internal&&i.append("internal",e.internal.toString()),e?.limit&&i.append("limit",e.limit.toString()),e?.order&&i.append("order",e.order),e?.timestamp&&i.append("timestamp",e.timestamp),e?.transactionIndex&&i.append("transaction.index",e.transactionIndex.toString());const r=i.toString();r&&(t+=`?${r}`);try{return(await this._requestWithRetry(t)).results||[]}catch(n){return this.logger.error(`Error fetching contract results: ${n.message}`),null}}async getContractResult(e,t){this.logger.info(`Getting contract result for ${e}`);let i=`/api/v1/contracts/results/${e}`;void 0!==t&&(i+=`?nonce=${t}`);try{return await this._requestWithRetry(i)}catch(r){return this.logger.error(`Error fetching contract result for ${e}: ${r.message}`),null}}async getContractResultsByContract(e,t){this.logger.info(`Getting contract results for contract ${e}`);let i=`/api/v1/contracts/${e}/results`;const r=new URLSearchParams;t?.blockHash&&r.append("block.hash",t.blockHash),t?.blockNumber&&r.append("block.number",t.blockNumber),t?.from&&r.append("from",t.from),void 0!==t?.internal&&r.append("internal",t.internal.toString()),t?.limit&&r.append("limit",t.limit.toString()),t?.order&&r.append("order",t.order),t?.timestamp&&r.append("timestamp",t.timestamp),t?.transactionIndex&&r.append("transaction.index",t.transactionIndex.toString());const n=r.toString();n&&(i+=`?${n}`);try{return(await this._requestWithRetry(i)).results||[]}catch(o){return this.logger.error(`Error fetching contract results for ${e}: ${o.message}`),null}}async getContractState(e,t){this.logger.info(`Getting contract state for ${e}`);let i=`/api/v1/contracts/${e}/state`;const r=new URLSearchParams;t?.limit&&r.append("limit",t.limit.toString()),t?.order&&r.append("order",t.order),t?.slot&&r.append("slot",t.slot),t?.timestamp&&r.append("timestamp",t.timestamp);const n=r.toString();n&&(i+=`?${n}`);try{return(await this._requestWithRetry(i)).state||[]}catch(o){return this.logger.error(`Error fetching contract state for ${e}: ${o.message}`),null}}async getContractActions(e,t){this.logger.info(`Getting contract actions for ${e}`);let i=`/api/v1/contracts/results/${e}/actions`;const r=new URLSearchParams;t?.index&&r.append("index",t.index),t?.limit&&r.append("limit",t.limit.toString()),t?.order&&r.append("order",t.order);const n=r.toString();n&&(i+=`?${n}`);try{return(await this._requestWithRetry(i)).actions||[]}catch(o){return this.logger.error(`Error fetching contract actions for ${e}: ${o.message}`),null}}async getContractLogs(e){this.logger.info("Getting contract logs from the network");let t="/api/v1/contracts/results/logs";const i=new URLSearchParams;e?.index&&i.append("index",e.index),e?.limit&&i.append("limit",e.limit.toString()),e?.order&&i.append("order",e.order),e?.timestamp&&i.append("timestamp",e.timestamp),e?.topic0&&i.append("topic0",e.topic0),e?.topic1&&i.append("topic1",e.topic1),e?.topic2&&i.append("topic2",e.topic2),e?.topic3&&i.append("topic3",e.topic3),e?.transactionHash&&i.append("transaction.hash",e.transactionHash);const r=i.toString();r&&(t+=`?${r}`);try{return(await this._requestWithRetry(t)).logs||[]}catch(n){return this.logger.error(`Error fetching contract logs: ${n.message}`),null}}async getContractLogsByContract(e,t){this.logger.info(`Getting contract logs for contract ${e}`);let i=`/api/v1/contracts/${e}/results/logs`;const r=new URLSearchParams;t?.index&&r.append("index",t.index),t?.limit&&r.append("limit",t.limit.toString()),t?.order&&r.append("order",t.order),t?.timestamp&&r.append("timestamp",t.timestamp),t?.topic0&&r.append("topic0",t.topic0),t?.topic1&&r.append("topic1",t.topic1),t?.topic2&&r.append("topic2",t.topic2),t?.topic3&&r.append("topic3",t.topic3);const n=r.toString();n&&(i+=`?${n}`);try{return(await this._requestWithRetry(i)).logs||[]}catch(o){return this.logger.error(`Error fetching contract logs for ${e}: ${o.message}`),null}}async getNftInfo(e,t){this.logger.info(`Getting NFT info for ${e}/${t}`);const i=`/api/v1/tokens/${e}/nfts/${t}`;try{return await this._requestWithRetry(i)}catch(r){return this.logger.error(`Error fetching NFT info for ${e}/${t}: ${r.message}`),null}}async getNftsByToken(e,t){this.logger.info(`Getting NFTs for token ${e}`);let i=`/api/v1/tokens/${e}/nfts`;const r=new URLSearchParams;t?.accountId&&r.append("account.id",t.accountId),t?.limit&&r.append("limit",t.limit.toString()),t?.order&&r.append("order",t.order),t?.serialNumber&&r.append("serialnumber",t.serialNumber);const n=r.toString();n&&(i+=`?${n}`);try{return(await this._requestWithRetry(i)).nfts||[]}catch(o){return this.logger.error(`Error fetching NFTs for token ${e}: ${o.message}`),null}}async getNetworkInfo(){this.logger.info("Getting network information");try{return await this._requestWithRetry("/api/v1/network/nodes")}catch(e){return this.logger.error(`Error fetching network info: ${e.message}`),null}}async getNetworkFees(e){this.logger.info("Getting network fees");let t="/api/v1/network/fees";e&&(t+=`?timestamp=${e}`);try{return await this._requestWithRetry(t)}catch(i){return this.logger.error(`Error fetching network fees: ${i.message}`),null}}async getNetworkSupply(e){this.logger.info("Getting network supply");let t="/api/v1/network/supply";e&&(t+=`?timestamp=${e}`);try{return await this._requestWithRetry(t)}catch(i){return this.logger.error(`Error fetching network supply: ${i.message}`),null}}async getNetworkStake(e){this.logger.info("Getting network stake");let t="/api/v1/network/stake";e&&(t+=`?timestamp=${e}`);try{return await this._requestWithRetry(t)}catch(i){return this.logger.error(`Error fetching network stake: ${i.message}`),null}}async getOpcodeTraces(e,t){this.logger.info(`Getting opcode traces for ${e}`);let i=`/api/v1/contracts/results/${e}/opcodes`;const r=new URLSearchParams;void 0!==t?.stack&&r.append("stack",t.stack.toString()),void 0!==t?.memory&&r.append("memory",t.memory.toString()),void 0!==t?.storage&&r.append("storage",t.storage.toString());const n=r.toString();n&&(i+=`?${n}`);try{return await this._requestWithRetry(i)}catch(o){return this.logger.error(`Error fetching opcode traces for ${e}: ${o.message}`),null}}};class HCS6BaseClient{constructor(e){this.network=e.network,this.logger=e.logger||Logger$e.getInstance({level:e.logLevel||"info",module:"HCS6Client",silent:e.silent}),this.mirrorNode=new HederaMirrorNode$3(this.network,this.logger,e.mirrorNodeUrl?{customUrl:e.mirrorNodeUrl}:void 0)}parseRegistryTypeFromMemo(e){try{const t=/hcs-6:(\d):(\d+)/,i=e.match(t);if(i&&3===i.length){const e=parseInt(i[1]),t=parseInt(i[2]);if(e===HCS6RegistryType.NON_INDEXED&&validateHCS6TTL(t))return{registryType:e,ttl:t}}return}catch(t){return void this.logger.error(`Error parsing HCS-6 registry type from memo: ${t}`)}}generateRegistryMemo(e){return generateHCS6RegistryMemo(e)}validateMessage(e){try{return hcs6MessageSchema.parse(e),{valid:!0,errors:[]}}catch(t){const e=[];return t instanceof zod.ZodError?t.errors.forEach(t=>{const i=t.path.join(".");e.push(`${i?i+": ":""}${t.message}`)}):e.push(`Unexpected error: ${t}`),this.logger.debug(`HCS-6 message validation failed: ${e.join(", ")}`),{valid:!1,errors:e}}}createRegisterMessage(e,t){return{p:"hcs-6",op:HCS6Operation.REGISTER,t_id:e,m:t}}parseRegistryEntries(e,t,i,r){const n=[];let o;this.logger.debug(`Parsing ${t.length} messages for HCS-6 topic ${e}`);for(const s of t)try{if(!s.message){this.logger.debug(`Message is missing 'message' property: ${JSON.stringify(s)}`);continue}const t=globalThis.Buffer.from(s.message,"base64").toString("utf-8"),r=JSON.parse(t);this.logger.debug(`Successfully parsed HCS-6 message: ${JSON.stringify(r)}`);const{valid:a,errors:c}=this.validateMessage(r);if(!a){this.logger.warn(`Invalid HCS-6 message: ${c.join(", ")}`);continue}const u={topicId:e,sequence:s.sequence_number,timestamp:s.consensus_timestamp,payer:s.payer_account_id,message:r,consensus_timestamp:s.consensus_timestamp,registry_type:i};n.push(u),(!o||u.timestamp>o.timestamp)&&(o=u)}catch(a){this.logger.warn(`Error parsing HCS-6 message: ${a}`)}return this.logger.debug(`Parsed ${n.length} valid entries for HCS-6 topic ${e}`),{topicId:e,registryType:i,ttl:r,entries:o?[o]:[],latestEntry:o}}async validateHCS6Topic(e){try{const t=await this.mirrorNode.getTopicInfo(e),i=this.parseRegistryTypeFromMemo(t.memo);return i?i.registryType===HCS6RegistryType.NON_INDEXED||(this.logger.warn(`Topic ${e} is not a valid HCS-6 registry (must be non-indexed)`),!1):(this.logger.warn(`Topic ${e} is not a valid HCS-6 registry (invalid memo format)`),!1)}catch(t){return this.logger.error(`Error validating HCS-6 topic ${e}: ${t}`),!1}}}function encodeHcs2RegistryMemo(e,t){return`hcs-2:${e}:${t}`}function buildTopicCreateTx(e){const{memo:t,adminKey:i,submitKey:r,operatorPublicKey:n}=e,o=(new sdk.TopicCreateTransaction).setTopicMemo(t),a=e=>{if(e){if(e instanceof sdk.PublicKey||e instanceof sdk.KeyList)return e;if("boolean"==typeof e)return e?n:void 0;if("string"==typeof e)try{return sdk.PublicKey.fromString(e)}catch{return}}},s=a(i);s&&o.setAdminKey(s);const c=a(r);return c&&o.setSubmitKey(c),o}function buildMessageTx(e){const t=(new sdk.TopicMessageSubmitTransaction).setTopicId(sdk.TopicId.fromString(e.topicId)).setMessage(e.message);return e.transactionMemo&&t.setTransactionMemo(e.transactionMemo),t}function encodeHcs6NonIndexedMemo(e){return`hcs-6:1:${e}`}function buildHcs6CreateRegistryTx(e){return buildTopicCreateTx({memo:e.memoOverride??encodeHcs6NonIndexedMemo(e.ttl),submitKey:e.submitKey,adminKey:e.adminKey,operatorPublicKey:e.operatorPublicKey})}function buildHcs6RegisterEntryTx(e){const t={p:"hcs-6",op:HCS6Operation.REGISTER,t_id:e.targetTopicId,m:e.memo};return buildMessageTx({topicId:e.registryTopicId,message:JSON.stringify(t),transactionMemo:e.analyticsMemo})}var KeyType=(e=>(e.ED25519="ed25519",e.ECDSA="ecdsa",e.UNKNOWN="unknown",e))(KeyType||{});let KeyTypeDetector$4=(_b2=class{static detect(e){try{let t,i="raw";if("string"==typeof e){let r=e.trim();if(r.includes("-----BEGIN"))return this.detectFromPem(r);if(r.toLowerCase().startsWith("0x")&&(r=r.substring(2)),this.isValidHex(r))t=this.hexToBytes(r),i="hex";else{if(!this.isBase64(r))return{type:"unknown",format:"raw",isPrivateKey:!1,confidence:"certain"};t=globalThis.Buffer.from(r,"base64"),i="der"}}else t=e instanceof globalThis.Buffer?new Uint8Array(e):e;return this.detectFromBytes(t,i)}catch(t){return{type:"unknown",format:"raw",isPrivateKey:!1,confidence:"certain"}}}static detectFromBytes(e,t){if(this.hasPrefix(e,this.ED25519_PUBLIC_KEY_PREFIX)){const t=this.ED25519_PUBLIC_KEY_PREFIX.length;return{type:"ed25519",format:"der",isPrivateKey:!1,rawBytes:e.slice(t),confidence:"certain"}}if(this.hasPrefix(e,this.ED25519_PRIVATE_KEY_PREFIX)){const t=this.ED25519_PRIVATE_KEY_PREFIX.length;if(e.length>=t+32)return{type:"ed25519",format:"der",isPrivateKey:!0,rawBytes:e.slice(t,t+32),confidence:"certain"}}if(this.hasPrefix(e,this.ECDSA_SECP256K1_PUBLIC_KEY_PREFIX)){const t=this.ECDSA_SECP256K1_PUBLIC_KEY_PREFIX.length;return{type:"ecdsa",format:"der",isPrivateKey:!1,rawBytes:e.slice(t),confidence:"certain"}}if(this.hasPrefix(e,this.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX_SHORT)){const t=this.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX_SHORT.length;return{type:"ecdsa",format:"der",isPrivateKey:!0,rawBytes:e.slice(t),confidence:"certain"}}if(this.hasPrefix(e,this.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX)){const t=this.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX.length;return{type:"ecdsa",format:"der",isPrivateKey:!0,rawBytes:e.slice(t,t+32),confidence:"certain"}}if(this.hasPrefix(e,this.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX_LONG)){const t=this.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX_LONG.length;return{type:"ecdsa",format:"der",isPrivateKey:!0,rawBytes:e.slice(t,t+32),confidence:"certain"}}if(e.length>36&&this.containsECDSAPrivateKeyPattern(e))return{type:"ecdsa",format:"der",isPrivateKey:!0,rawBytes:this.extractECDSAPrivateKey(e),confidence:"certain"};switch(e.length){case this.ED25519_PUBLIC_KEY_LENGTH:if("hex"===t){const t=Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join(""),i=this.tryCreateKey(t);if("unknown"!==i.type)return i}return{type:"unknown",format:t,isPrivateKey:!1,rawBytes:e,confidence:"certain"};case this.ED25519_EXPANDED_PRIVATE_KEY_LENGTH:return{type:"ed25519",format:t,isPrivateKey:!0,rawBytes:e,confidence:"certain"}}return{type:"unknown",format:t,isPrivateKey:!1,rawBytes:e,confidence:"certain"}}static detectFromPem(e){const t=e.trim(),i=t.includes("PRIVATE KEY"),r={EC_PRIVATE:/-----BEGIN EC PRIVATE KEY-----/,EC_PUBLIC:/-----BEGIN EC PUBLIC KEY-----/,PRIVATE:/-----BEGIN PRIVATE KEY-----/,PUBLIC:/-----BEGIN PUBLIC KEY-----/};let n=!1;for(const[s,c]of Object.entries(r))if(c.test(t)&&s.includes("EC")){n=!0;break}const o=t.match(/-----BEGIN[\s\S]+?-----[\r\n]+([\s\S]+?)[\r\n]+-----END/);if(!o)return{type:"unknown",format:"pem",isPrivateKey:i,confidence:"certain"};const a=o[1].replace(/\s/g,"");try{const e=globalThis.Buffer.from(a,"base64"),t=this.detectFromBytes(new Uint8Array(e),"der");return"unknown"===t.type&&n?{type:"ecdsa",format:"pem",isPrivateKey:i,rawBytes:e,confidence:"certain"}:{...t,format:"pem"}}catch{return{type:"unknown",format:"pem",isPrivateKey:i,confidence:"certain"}}}static tryCreateKey(e){try{if("string"==typeof e){let t=e.trim();if(t.toLowerCase().startsWith("0x")&&(t=t.substring(2)),this.isValidHex(t)&&64===t.length){const e=this.hexToBytes(t),i=this.detectBySignature(t);return"unknown"!==i.type?{type:i.type,format:"hex",isPrivateKey:!0,rawBytes:e,confidence:i.confidence,warning:i.warning}:{type:"unknown",format:"hex",isPrivateKey:!1,rawBytes:e,confidence:"certain"}}}}catch{}return{type:"unknown",format:"hex",isPrivateKey:!1,rawBytes:new Uint8Array,confidence:"certain"}}static detectBySignature(e){const t=BigInt("0x"+e),i=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141");if(0n===t)return{type:"ed25519",confidence:"certain"};if(t>=i)return{type:"ed25519",confidence:"certain"};let r=!1,n=!1;try{const t=sdk.PrivateKey.fromStringED25519(e),i=new Uint8Array([1,2,3,4,5]),n=t.sign(i);t.publicKey.verify(i,n)&&(r=!0)}catch{}try{const t=sdk.PrivateKey.fromStringECDSA(e),i=new Uint8Array([1,2,3,4,5]),r=t.sign(i);t.publicKey.verify(i,r)&&(n=!0)}catch{}if(r&&n){const t=this.hexToBytes(e);if(168===t[0]&&1===t[1])return{type:"ed25519",confidence:"uncertain",warning:"Detection based on byte pattern heuristic. Both ED25519 and ECDSA accept this key."};let i=0;for(const e of t)e>=128&&i++;const r=i/t.length;return r>=.4&&r<=.6?{type:"ecdsa",confidence:"uncertain",warning:"Detection based on entropy heuristic. Both ED25519 and ECDSA accept this key."}:{type:"ecdsa",confidence:"uncertain",warning:"Detection based on entropy heuristic. Both ED25519 and ECDSA accept this key. Defaulting to ECDSA."}}return r&&!n?{type:"ed25519",confidence:"certain"}:n&&!r?{type:"ecdsa",confidence:"certain"}:{type:"unknown",confidence:"certain"}}static isValidHex(e){return/^[0-9a-fA-F]+$/.test(e)&&e.length%2==0}static isBase64(e){try{return globalThis.Buffer.from(e,"base64").toString("base64")===e}catch{return!1}}static hexToBytes(e){const t=new Uint8Array(e.length/2);for(let i=0;i<e.length;i+=2)t[i/2]=parseInt(e.substr(i,2),16);return t}static hasPrefix(e,t){if(e.length<t.length)return!1;for(let i=0;i<t.length;i++)if(e[i]!==t[i])return!1;return!0}static containsECDSAPrivateKeyPattern(e){for(let t=0;t<e.length-7;t++)if(48===e[t]&&116===e[t+1]&&2===e[t+2]&&1===e[t+3]&&1===e[t+4]&&4===e[t+5]&&32===e[t+6])return!0;return!1}static extractECDSAPrivateKey(e){for(let t=0;t<e.length-32;t++)if(4===e[t]&&32===e[t+1])return e.slice(t+2,t+34);return e}},_b2.ED25519_PUBLIC_KEY_LENGTH=32,_b2.ED25519_EXPANDED_PRIVATE_KEY_LENGTH=64,_b2.ED25519_PUBLIC_KEY_PREFIX=globalThis.Buffer.from([48,42,48,5,6,3,43,101,112,3,33,0]),_b2.ED25519_PRIVATE_KEY_PREFIX=globalThis.Buffer.from([48,46,2,1,0,48,5,6,3,43,101,112,4,34,4,32]),_b2.ECDSA_SECP256K1_PUBLIC_KEY_PREFIX=globalThis.Buffer.from([48,86,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10,3,66,0]),_b2.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX=globalThis.Buffer.from([48,116,2,1,1,4,32]),_b2.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX_SHORT=globalThis.Buffer.from([48,48,2,1,0,48,7,6,5,43,129,4,0,10,4,34,4,32]),_b2.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX_LONG=globalThis.Buffer.from([48,119,2,1,1,4,32]),_b2);function detectKeyTypeFromString$8(e){const t=KeyTypeDetector$4.detect(e);if("unknown"!==t.type)try{const i="ecdsa"===t.type?sdk.PrivateKey.fromStringECDSA(e):sdk.PrivateKey.fromStringED25519(e),r={detectedType:t.type,privateKey:i};return"uncertain"===t.confidence&&(r.warning="Key type detection is uncertain. If you have the associated account ID, consider using the Hedera mirror node to confirm the key type."),r}catch(i){}try{return{detectedType:"ecdsa",privateKey:sdk.PrivateKey.fromStringECDSA(e),warning:"Using ECDSA as default. If you have the associated account ID, consider using the Hedera mirror node to confirm the key type."}}catch(r){try{return{detectedType:"ed25519",privateKey:sdk.PrivateKey.fromStringED25519(e),warning:"Using ED25519 as fallback. If you have the associated account ID, consider using the Hedera mirror node to confirm the key type."}}catch(n){throw new Error(`Failed to parse private key as either ECDSA or ED25519: ${r}`)}}}class NodeOperatorResolver{constructor(e){this.mirror=e.mirrorNode,this.logger=e.logger}bestGuessOperatorKey(e,t){if("string"!=typeof e)return{keyType:t||"ecdsa",privateKey:e};if(t){return{keyType:t,privateKey:"ed25519"===t?sdk.PrivateKey.fromStringED25519(e):sdk.PrivateKey.fromStringECDSA(e)}}try{const t=detectKeyTypeFromString$8(e);return{keyType:t.detectedType,privateKey:t.privateKey}}catch{return{keyType:"ecdsa",privateKey:sdk.PrivateKey.fromStringECDSA(e)}}}async resolveOperatorKey(e,t,i){if("string"!=typeof t)return{keyType:i||"ecdsa",privateKey:t};if(i){return{keyType:i,privateKey:"ed25519"===i?sdk.PrivateKey.fromStringED25519(t):sdk.PrivateKey.fromStringECDSA(t)}}const r="string"==typeof e?e:e.toString();try{const e=await this.mirror.requestAccount(r),i=(e?.key?._type||"").includes("ED25519")?"ed25519":"ecdsa";return{keyType:i,privateKey:"ed25519"===i?sdk.PrivateKey.fromStringED25519(t):sdk.PrivateKey.fromStringECDSA(t)}}catch{return this.logger.warn("Mirror node key detection failed; using local detection or default ECDSA"),this.bestGuessOperatorKey(t)}}async resolveSupplyKey(e,t,i,r){try{const n=await this.mirror.getTokenInfo(e),o=n?.supply_key?._type||"";return"string"!=typeof t?t:r?"ed25519"===r?sdk.PrivateKey.fromStringED25519(t):sdk.PrivateKey.fromStringECDSA(t):o.includes("ED25519")?sdk.PrivateKey.fromStringED25519(t):o.includes("ECDSA")?sdk.PrivateKey.fromStringECDSA(t):"ed25519"===i?sdk.PrivateKey.fromStringED25519(t):sdk.PrivateKey.fromStringECDSA(t)}catch{return"string"!=typeof t?t:r?"ed25519"===r?sdk.PrivateKey.fromStringED25519(t):sdk.PrivateKey.fromStringECDSA(t):"ed25519"===i?sdk.PrivateKey.fromStringED25519(t):sdk.PrivateKey.fromStringECDSA(t)}}}function createNodeOperatorContext(e){const t="string"==typeof e.operatorId?sdk.AccountId.fromString(e.operatorId):e.operatorId,i=e.client?e.client:"mainnet"===e.network?sdk.Client.forMainnet():sdk.Client.forTestnet(),r=new NodeOperatorResolver({mirrorNode:e.mirrorNode,logger:e.logger});let n,o;const a=r.bestGuessOperatorKey(e.operatorKey,e.keyType);n=a.keyType,o=a.privateKey,i.setOperator(t.toString(),o);const s=(async()=>{try{const a=await r.resolveOperatorKey(t,e.operatorKey,e.keyType);n=a.keyType,o=a.privateKey,i.setOperator(t.toString(),o)}catch{}})();return{client:i,operatorId:t,get operatorKey(){return o},get keyType(){return n},ensureInitialized:async()=>{await s}}}var __defProp3=Object.defineProperty,__defNormalProp3=(e,t,i)=>t in e?__defProp3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,__publicField3=(e,t,i)=>__defNormalProp3(e,"symbol"!=typeof t?t+"":t,i),_a4,buffer$9={},base64Js$8={};base64Js$8.byteLength=byteLength$e,base64Js$8.toByteArray=toByteArray$8,base64Js$8.fromByteArray=fromByteArray$8;for(var lookup$e=[],revLookup$8=[],Arr$8="undefined"!=typeof Uint8Array?Uint8Array:Array,code$8="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i$a=0,len$8=code$8.length;i$a<len$8;++i$a)lookup$e[i$a]=code$8[i$a],revLookup$8[code$8.charCodeAt(i$a)]=i$a;function getLens$8(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function byteLength$e(e){var t=getLens$8(e),i=t[0],r=t[1];return 3*(i+r)/4-r}function _byteLength$8(e,t,i){return 3*(t+i)/4-i}function toByteArray$8(e){var t,i,r=getLens$8(e),n=r[0],o=r[1],a=new Arr$8(_byteLength$8(e,n,o)),s=0,c=o>0?n-4:n;for(i=0;i<c;i+=4)t=revLookup$8[e.charCodeAt(i)]<<18|revLookup$8[e.charCodeAt(i+1)]<<12|revLookup$8[e.charCodeAt(i+2)]<<6|revLookup$8[e.charCodeAt(i+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;return 2===o&&(t=revLookup$8[e.charCodeAt(i)]<<2|revLookup$8[e.charCodeAt(i+1)]>>4,a[s++]=255&t),1===o&&(t=revLookup$8[e.charCodeAt(i)]<<10|revLookup$8[e.charCodeAt(i+1)]<<4|revLookup$8[e.charCodeAt(i+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t),a}function tripletToBase64$8(e){return lookup$e[e>>18&63]+lookup$e[e>>12&63]+lookup$e[e>>6&63]+lookup$e[63&e]}function encodeChunk$8(e,t,i){for(var r,n=[],o=t;o<i;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),n.push(tripletToBase64$8(r));return n.join("")}function fromByteArray$8(e){for(var t,i=e.length,r=i%3,n=[],o=16383,a=0,s=i-r;a<s;a+=o)n.push(encodeChunk$8(e,a,a+o>s?s:a+o));return 1===r?(t=e[i-1],n.push(lookup$e[t>>2]+lookup$e[t<<4&63]+"==")):2===r&&(t=(e[i-2]<<8)+e[i-1],n.push(lookup$e[t>>10]+lookup$e[t>>4&63]+lookup$e[t<<2&63]+"=")),n.join("")}revLookup$8["-".charCodeAt(0)]=62,revLookup$8["_".charCodeAt(0)]=63;var ieee754$9={
+"use strict";var _a5,_b2;Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});let node_module;try{node_module=require("module")}catch{node_module={createRequire:()=>()=>{throw new Error("Dynamic require not supported")}}};const util$b=require("util"),zod=require("zod"),sdk=require("@hashgraph/sdk"),axios$9=require("axios"),proto=require("@hashgraph/proto"),buffer$a=require("buffer"),ethers=require("ethers"),fileType=require("file-type"),Redis=require("ioredis"),mime=require("mime-types"),dateFns=require("date-fns"),crypto$1=require("crypto");var _documentCurrentScript="undefined"!=typeof document?document.currentScript:null;function _interopNamespaceDefault(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e)for(const i in e)if("default"!==i){const r=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:()=>e[i]})}return t.default=e,Object.freeze(t)}const mime__namespace=_interopNamespaceDefault(mime),require$1=node_module.createRequire("undefined"==typeof document?require("url").pathToFileURL(__filename).href:_documentCurrentScript&&"SCRIPT"===_documentCurrentScript.tagName.toUpperCase()&&_documentCurrentScript.src||new URL("standards-sdk.cjs",document.baseURI).href),accountModule=safeRequire("@hashgraph/sdk/lib/account/AccountId.cjs"),topicModule=safeRequire("@hashgraph/sdk/lib/topic/TopicCreateTransaction.cjs"),sdkModule=safeRequire("@hashgraph/sdk"),accountIdPattern=/^\d+\.\d+\.\d+$/u,prototypeMarker=Symbol.for("standards-sdk.topic-auto-renew.patch"),accountMarker=Symbol.for("standards-sdk.account-id.patch"),candidates=[];accountModule?.default&&topicModule?.default&&candidates.push({accountId:accountModule.default,topic:topicModule.default}),sdkModule&&candidates.push({accountId:sdkModule.AccountId??sdkModule.default?.AccountId,topic:sdkModule.TopicCreateTransaction??sdkModule.default?.TopicCreateTransaction});for(const t of candidates)patchTopicModule(t.topic,t.accountId);function safeRequire(e){try{return require$1(e)}catch{return null}}function patchTopicModule(e,t){if(!e||!t)return;patchAccountId(t);const i=e.prototype;if(Reflect.get(i,prototypeMarker))return;const r=i.setAutoRenewAccountId,n=i.freezeWith;i.setAutoRenewAccountId=function(e){const i=resolveAccountId(e,t);return i?(requireNotFrozen(this),this._autoRenewAccountId=i,this):r.call(this,e)},i.freezeWith=function(e){if(!this.getAutoRenewAccountId||"function"!=typeof this.getAutoRenewAccountId)return n.call(this,e);if(!this.getAutoRenewAccountId()){const i=this.transactionId?.accountId,r=e?.operatorAccountId,n=resolveAccountId(i,t)??resolveAccountId(r,t);n&&(this._autoRenewAccountId=n)}return n.call(this,e)},Reflect.set(i,prototypeMarker,!0)}function patchAccountId(e){if(Reflect.get(e,accountMarker))return;const t=e.fromString.bind(e);e.fromString=function(e){if("string"==typeof e)return t(e);const i=extractAccountIdString(e);if(i)return t(i);if(isProtoAccountId(e)){const i=toNumericString(e.shard),r=toNumericString(e.realm),n=toNumericString(e.num);if(i&&r&&n)return t(`${i}.${r}.${n}`)}return t(e)},Reflect.set(e,accountMarker,!0)}function resolveAccountId(e,t){if(e instanceof t)return e;if("string"==typeof e&&accountIdPattern.test(e))return t.fromString(e);const i=normalizeAutoRenewValue(e);return i?t.fromString(i):null}function normalizeAutoRenewValue(e){if("string"==typeof e&&accountIdPattern.test(e))return e;const t=extractAccountIdString(e);if(t)return t;if(isProtoAccountId(e)){const t=toNumericString(e.shard),i=toNumericString(e.realm),r=toNumericString(e.num);if(t&&i&&r){const e=`${t}.${i}.${r}`;if(accountIdPattern.test(e))return e}}return null}function extractAccountIdString(e){if("object"!=typeof e||null===e)return null;const t=e.toString;if("function"!=typeof t)return null;const i=t.call(e);return"string"!=typeof i?null:accountIdPattern.test(i)?i:null}function isProtoAccountId(e){if("object"!=typeof e||null===e)return!1;const t=e;return hasToString(t.shard)&&hasToString(t.realm)&&hasToString(t.num)}function hasToString(e){return"object"==typeof e&&null!==e&&"function"==typeof e.toString}function toNumericString(e){if("number"==typeof e&&Number.isFinite(e))return String(Math.trunc(e));if("bigint"==typeof e)return e.toString();if(hasToString(e)){const t=e.toString();if(/^\d+$/u.test(t))return t}return null}function requireNotFrozen(e){const t=e;t._requireNotFrozen?.()}Reflect.set(globalThis,"__standardsSdkTopicAutoRenewPatched",!0);let loggerFactory=null;function setLoggerFactory(e){loggerFactory=e,Logger$e.clearInstances()}let Logger$e=(_a5=class{constructor(e={}){if(loggerFactory)return loggerFactory(e);const t="undefined"!=typeof process&&"true"===process.env?.DISABLE_LOGS;this.silent=e.silent||t,this.level=this.silent?"silent":e.level||"info",this.moduleContext=e.module||"app",this.prettyPrint=!this.silent&&!1!==e.prettyPrint}static getInstance(e={}){const t=e.module||"default";if("undefined"!=typeof process&&"true"===process.env?.DISABLE_LOGS&&_a5.instances.has(t)){"silent"!==_a5.instances.get(t).getLevel()&&_a5.instances.delete(t)}if(!_a5.instances.has(t)){const i=loggerFactory?loggerFactory(e):new _a5(e);_a5.instances.set(t,i)}return _a5.instances.get(t)}setLogLevel(e){this.level=e}getLevel(){return this.level}setSilent(e){this.silent=e,e&&(this.level="silent")}setModule(e){this.moduleContext=e}formatArgs(e){if(0===e.length)return{msg:""};if(1===e.length)return"string"==typeof e[0]?{msg:e[0]}:{msg:"",data:e[0]};const t=[],i=[];e.forEach(e=>{"string"==typeof e||"number"==typeof e||"boolean"==typeof e?t.push(String(e)):i.push(e)});const r=t.join(" ");return i.length>0?{msg:r,data:i}:{msg:r}}shouldLog(e){if(this.silent||"silent"===this.level)return!1;const t=["trace","debug","info","warn","error","silent"],i=t.indexOf(this.level);return t.indexOf(e)>=i}getConsoleMethod(e){return"error"===e?console.error:"warn"===e?console.warn:"debug"===e?console.debug:console.log}writeLog(e,...t){if(!this.shouldLog(e))return;const{msg:i,data:r}=this.formatArgs(t),n=(new Date).toISOString(),o=this.getConsoleMethod(e);if(this.prettyPrint){let t=`${n} ${e.toUpperCase().padEnd(5)} [${this.moduleContext}] ${i}`;r&&(t+="\n"+util$b.inspect(r,{colors:!0,depth:3})),o(t)}else{const t={timestamp:n,level:e,module:this.moduleContext,message:i,...r&&{data:r}};o(JSON.stringify(t))}}debug(...e){this.writeLog("debug",...e)}info(...e){this.writeLog("info",...e)}warn(...e){this.writeLog("warn",...e)}error(...e){this.writeLog("error",...e)}trace(...e){this.writeLog("trace",...e)}static clearInstances(){_a5.instances.clear()}},_a5.instances=new Map,_a5);const sleep=e=>new Promise(t=>setTimeout(t,e));class HCS{constructor(){this.modelViewerLoaded=!1,this.modelViewerLoading=null,this.config={cdnUrl:"https://kiloscribe.com/api/inscription-cdn/",network:"mainnet",retryAttempts:3,retryBackoff:300,debug:!1,showLoadingIndicator:!1,loadingCallbackName:null},this.configMapping={hcsCdnUrl:"cdnUrl",hcsNetwork:"network",hcsRetryAttempts:"retryAttempts",hcsRetryBackoff:"retryBackoff",hcsDebug:"debug",hcsShowLoadingIndicator:"showLoadingIndicator",hcsLoadingCallbackName:"loadingCallbackName"},this.LoadedScripts={},this.LoadedWasm={},this.LoadedImages={},this.LoadedVideos={},this.LoadedAudios={},this.LoadedAudioUrls={},this.LoadedGLBs={},this.scriptLoadedEvent=new Event("HCSScriptLoaded"),this.loadQueue=[],this.isProcessingQueue=!1;try{this.logger=Logger$e.getInstance({module:"HCS-3",level:this.config.debug?"debug":"error"})}catch(e){this.logger=this.createFallbackLogger()}}createFallbackLogger(){return{debug:(...e)=>this.config.debug&&console.debug("[HCS-3]",...e),info:(...e)=>this.config.debug&&console.info("[HCS-3]",...e),warn:(...e)=>console.warn("[HCS-3]",...e),error:(...e)=>console.error("[HCS-3]",...e),setLogLevel:e=>{this.config.debug="debug"===e}}}log(...e){if(0===e.length)this.logger.debug("");else if(1===e.length)this.logger.debug(String(e[0]));else{const t=String(e[0]),i=e.slice(1);this.logger.debug(t,i)}}error(...e){if(0===e.length)this.logger.error("");else if(1===e.length)this.logger.error(String(e[0]));else{const t=String(e[0]),i=e.slice(1);this.logger.error(t,i)}}loadConfigFromHTML(){const e=document.querySelector("script[data-hcs-config]");e&&(Object.keys(this.configMapping).forEach(t=>{if(e.dataset[t]){const i=this.configMapping[t];let r=e.dataset[t];"true"===r&&(r=!0),"false"===r&&(r=!1),isNaN(Number(r))||""===r||(r=Number(r)),this.config[i]=r}}),this.logger.setLogLevel(this.config.debug?"debug":"error")),this.log("Loaded config:",this.config)}updateLoadingStatus(e,t){if("loaded"!==this.LoadedScripts[e]&&(this.config.showLoadingIndicator&&console.log("[HCS Loading] "+e+" : "+t),this.LoadedScripts[e]=t,this.config.loadingCallbackName&&"function"==typeof window[this.config.loadingCallbackName])){const i=window[this.config.loadingCallbackName];"function"==typeof i&&i(e,t)}}async fetchWithRetry(e,t=this.config.retryAttempts,i=this.config.retryBackoff){try{const t=await fetch(e);if(!t.ok)throw new Error("HTTP error! status: "+t.status);return t}catch(r){if(t>0)return this.log("Retrying fetch for "+e+" Attempts left: "+(t-1)),await this.sleep(i),this.fetchWithRetry(e,t-1,2*i);throw r}}sleep(e){return sleep(e)}isDuplicate(e){return!!this.LoadedScripts[e]}async retrieveHCS1Data(e,t=this.config.cdnUrl,i=this.config.network){const r=i.replace(/['"]+/g,""),n=await this.fetchWithRetry(t+e+"?network="+r);return await n.blob()}async loadScript(e){const t=e.getAttribute("data-src"),i=e.getAttribute("data-script-id"),r=t?.split("/").pop(),n=e.getAttribute("type"),o=e.hasAttribute("data-required"),a="module"===e.getAttribute("type");if(!this.isDuplicate(r||"")){this.updateLoadingStatus(i,"loading");try{const t=e.getAttribute("data-cdn-url")||this.config.cdnUrl,s=e.getAttribute("data-network")||this.config.network,c=await this.retrieveHCS1Data(r,t,s);if("wasm"===n){const t=await c.arrayBuffer(),r=await WebAssembly.compile(t);this.LoadedWasm[i]=await WebAssembly.instantiate(r,{env:{},...e.dataset}),this.updateLoadingStatus(i,"loaded"),window.dispatchEvent(this.scriptLoadedEvent),this.log("Loaded wasm: "+i)}else{const e=await c.text(),t=document.createElement("script");if(t.textContent=e,t.className="hcs-inline-script",i&&t.setAttribute("data-loaded-script-id",i),a){t.type="module";const i=new Blob([e],{type:"application/javascript"});t.src=URL.createObjectURL(i)}document.body.appendChild(t),this.updateLoadingStatus(i,"loaded"),window.dispatchEvent(this.scriptLoadedEvent),this.log("Loaded script: "+i),t.onerror=e=>{if(this.error("Failed to load "+n+": "+i,e),this.updateLoadingStatus(i,"failed"),o)throw e}}}catch(s){if(this.error("Failed to load "+n+": "+i,s),this.updateLoadingStatus(i,"failed"),o)throw s}}}async loadModuleExports(e){const t=document.querySelector('script[data-loaded-script-id="'+e+'"]');if(!t)throw new Error("Module script with id "+e+" not found");const i=t.getAttribute("src");if(!i)throw new Error("Module script "+e+" has no src attribute");try{const e=new Function("url","return import(url)");return await e(i)}catch(r){throw this.error("Failed to import module",r),r}}async loadStylesheet(e){const t=e.getAttribute("data-src"),i=e.getAttribute("data-script-id"),r=t?.split("/").pop(),n=e.hasAttribute("data-required");if(!this.isDuplicate(r||"")){this.updateLoadingStatus(i,"loading");try{const t=e.getAttribute("data-cdn-url")||this.config.cdnUrl,n=e.getAttribute("data-network")||this.config.network,o=await this.retrieveHCS1Data(r,t,n),a=await o.text(),s=document.createElement("style");s.textContent=a,document.head.appendChild(s),this.updateLoadingStatus(i,"loaded"),window.dispatchEvent(this.scriptLoadedEvent),this.log("Loaded and inlined stylesheet: "+i)}catch(o){if(this.error("Failed to load stylesheet: "+i,o),this.updateLoadingStatus(i,"failed"),n)throw o}}}async loadImage(e){const t=e.getAttribute("data-src"),i=t?.split("/").pop();this.log("Loading image: "+i),this.updateLoadingStatus("Image: "+i,"loaded");try{const t=e.getAttribute("data-cdn-url")||this.config.cdnUrl,r=e.getAttribute("data-network")||this.config.network,n=await this.retrieveHCS1Data(i,t,r),o=URL.createObjectURL(n);e.src=o,this.LoadedImages[i]=o,this.updateLoadingStatus("Image: "+i,"loaded"),this.log("Loaded image: "+i)}catch(r){this.error("Failed to load image: "+i,r),this.updateLoadingStatus("Image: "+i,"failed")}}async loadMedia(e,t){const i=e.getAttribute("data-src"),r=i?.split("/").pop();this.log("Loading "+t+": "+r),this.updateLoadingStatus(t+": "+r,"loading");try{const i=e.getAttribute("data-cdn-url")||this.config.cdnUrl,n=e.getAttribute("data-network")||this.config.network,o=await this.retrieveHCS1Data(r,i,n),a=URL.createObjectURL(o);e.src=a,"video"===t?this.LoadedVideos[r]=a:this.LoadedAudioUrls[r]=a,this.updateLoadingStatus(t+": "+r,"loaded"),this.log("Loaded "+t+": "+r)}catch(n){this.error("Failed to load "+t+": "+r,n),this.updateLoadingStatus(t+": "+r,"failed")}}async loadModelViewer(){return this.modelViewerLoading?this.modelViewerLoading:this.modelViewerLoaded?Promise.resolve():(this.modelViewerLoading=new Promise(e=>{const t=document.createElement("script");t.setAttribute("data-src","hcs://1/0.0.7293044"),t.setAttribute("data-script-id","model-viewer"),t.setAttribute("type","module"),window.addEventListener("HCSScriptLoaded",()=>{this.modelViewerLoaded=!0,e()},{once:!0}),this.loadScript(t)}),this.modelViewerLoading)}async loadGLB(e){await this.loadModelViewer();const t=e.getAttribute("data-src"),i=t?.split("/").pop();this.log("Loading GLB: "+i),this.updateLoadingStatus("GLB: "+i,"loading");try{const t=e.getAttribute("data-cdn-url")||this.config.cdnUrl,r=e.getAttribute("data-network")||this.config.network;let n;"model-viewer"!==e.tagName.toLowerCase()?(n=document.createElement("model-viewer"),Array.from(e.attributes).forEach(e=>{n.setAttribute(e.name,e.value)}),n.setAttribute("camera-controls",""),n.setAttribute("auto-rotate",""),n.setAttribute("ar",""),e.parentNode?.replaceChild(n,e)):n=e;const o=await this.retrieveHCS1Data(i,t,r),a=URL.createObjectURL(o);n.setAttribute("src",a),this.LoadedGLBs[i]=a,this.updateLoadingStatus("GLB: "+i,"loaded"),this.log("Loaded GLB: "+i)}catch(r){this.error("Failed to load GLB: "+i,r),this.updateLoadingStatus("GLB: "+i,"failed")}}async loadResource(e,t,i){return new Promise(r=>{this.loadQueue.push({element:e,type:t,order:i,resolve:r}),this.processQueue()})}async processQueue(){if(!this.isProcessingQueue){for(this.isProcessingQueue=!0;this.loadQueue.length>0;){const t=this.loadQueue.shift();try{"script"===t.type?await this.loadScript(t.element):"image"===t.type?await this.loadImage(t.element):"video"===t.type||"audio"===t.type?await this.loadMedia(t.element,t.type):"glb"===t.type?await this.loadGLB(t.element):"css"===t.type&&await this.loadStylesheet(t.element),t.resolve()}catch(e){if(this.error("Error processing queue item:",e),"script"===t.type&&t.element.hasAttribute("data-required"))break}}this.isProcessingQueue=!1}}async replaceHCSInStyle(e){let t=e,i=t.indexOf("hcs://");for(;-1!==i;){let e=i;for(;e<t.length&&!["'",'"'," ",")"].includes(t[e]);)e++;const n=t.substring(i,e),o=n.split("/").pop();try{const r=this.config.cdnUrl,a=this.config.network,s=await this.retrieveHCS1Data(o,r,a),c=URL.createObjectURL(s);t=t.substring(0,i)+c+t.substring(e),this.LoadedImages[o]=c,this.log("Replaced CSS HCS URL: "+n+" with "+c)}catch(r){this.error("Failed to load CSS image: "+o,r)}i=t.indexOf("hcs://",i+1)}return t}async processInlineStyles(){const e=document.querySelectorAll('[style*="hcs://"]');this.log("Found "+e.length+" elements with HCS style references");for(const i of Array.from(e)){const e=i.getAttribute("style");if(e){this.log("Processing style: "+e);const t=await this.replaceHCSInStyle(e);e!==t&&(i.setAttribute("style",t),this.log("Updated style to: "+t))}}const t=document.querySelectorAll("style");for(const i of Array.from(t))if(i.textContent?.includes("hcs://")){const e=await this.replaceHCSInStyle(i.textContent);i.textContent!==e&&(i.textContent=e)}}async init(){return this.loadConfigFromHTML(),new Promise(e=>{const t=async()=>{const t=document.querySelectorAll('script[data-src^="hcs://"]'),i=document.querySelectorAll('img[data-src^="hcs://"], img[src^="hcs://"]'),r=document.querySelectorAll('video[data-src^="hcs://"], video[src^="hcs://"]'),n=document.querySelectorAll('audio[data-src^="hcs://"], audio[src^="hcs://"]'),o=document.querySelectorAll('model-viewer[data-src^="hcs://"]'),a=document.querySelectorAll('link[data-src^="hcs://"]');document.querySelectorAll('[src^="hcs://"]').forEach(e=>{const t=e.getAttribute("src");t&&(e.setAttribute("data-src",t),e.removeAttribute("src"))}),await this.processInlineStyles();const s=[];[{elements:t,type:"script"},{elements:i,type:"image"},{elements:r,type:"video"},{elements:n,type:"audio"},{elements:o,type:"glb"},{elements:a,type:"css"}].forEach(({elements:e,type:t})=>{e.forEach(e=>{const i=parseInt(e.getAttribute("data-load-order")||"")||1/0;s.push(this.loadResource(e,t,i))})}),await Promise.all(s);const c=new MutationObserver(e=>{e.forEach(e=>{if(e.addedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){const t=e;if(t.getAttribute("style")?.includes("hcs://")&&this.processInlineStyles(),"style"===t.tagName.toLowerCase()&&t.textContent?.includes("hcs://")&&this.processInlineStyles(),t.getAttribute("src")?.startsWith("hcs://")){const e=t.getAttribute("src");t.setAttribute("data-src",e),t.removeAttribute("src");switch(t.tagName.toLowerCase()){case"img":this.loadResource(t,"image",1/0);break;case"video":this.loadResource(t,"video",1/0);break;case"audio":this.loadResource(t,"audio",1/0);break;case"script":this.loadResource(t,"script",1/0)}}t.matches('script[data-src^="hcs://"]')?this.loadResource(t,"script",1/0):t.matches('img[data-src^="hcs://"]')?this.loadResource(t,"image",1/0):t.matches('video[data-src^="hcs://"]')?this.loadResource(t,"video",1/0):t.matches('audio[data-src^="hcs://"]')?this.loadResource(t,"audio",1/0):t.matches('model-viewer[data-src^="hcs://"]')?this.loadResource(t,"glb",1/0):t.matches('link[data-src^="hcs://"]')&&this.loadResource(t,"css",1/0);t.querySelectorAll('[data-src^="hcs://"], [src^="hcs://"]').forEach(e=>{const t=e,i=t.tagName.toLowerCase(),r=t.getAttribute("src");switch(r?.startsWith("hcs://")&&(t.setAttribute("data-src",r),t.removeAttribute("src")),i){case"script":this.loadResource(t,"script",1/0);break;case"img":this.loadResource(t,"image",1/0);break;case"video":this.loadResource(t,"video",1/0);break;case"audio":this.loadResource(t,"audio",1/0);break;case"model-viewer":this.loadResource(t,"glb",1/0);break;case"link":this.loadResource(t,"css",1/0)}})}}),"attributes"===e.type){const t=e.target;if("style"===e.attributeName&&t.getAttribute("style")?.includes("hcs://"))this.processInlineStyles();else if("src"===e.attributeName){const e=t.getAttribute("src");if(e?.startsWith("hcs://")){t.setAttribute("data-src",e),t.removeAttribute("src");const i=t.tagName.toLowerCase();["img","video","audio"].includes(i)&&this.loadResource(t,i,1/0)}}}})});document.body?c.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","src","data-src"]}):document.addEventListener("DOMContentLoaded",()=>{c.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","src","data-src"]})}),e()};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()})}async preloadImage(e){this.log("Loading image:"+e),this.updateLoadingStatus("image: "+e,"loading");const t=await this.retrieveHCS1Data(e),i=URL.createObjectURL(t);return this.LoadedImages[e]=i,this.updateLoadingStatus("image: "+e,"loaded"),i}async preloadAudio(e){const t=document.createElement("audio");t.setAttribute("data-topic-id",e),t.setAttribute("data-src","hcs://1/"+e),document.body.appendChild(t),await this.loadMedia(t,"audio");const i=document.querySelector('audio[data-topic-id="'+e+'"]');return i?this.LoadedAudioUrls[e]=i.src:console.error("Failed to preload audio: "+e),this.LoadedAudioUrls[e]}async playAudio(e,t=1){const i=this.LoadedAudioUrls[e];if(i){const r=new Audio(i);r.volume=t,this.LoadedAudios[e]=r,r.play().catch(e=>{console.error("Failed to play audio:",e)}),r.addEventListener("ended",()=>{r.remove(),delete this.LoadedAudios[e]})}else console.error("Audio not preloaded: "+e)}async pauseAudio(e){const t=document.querySelector('audio[data-topic-id="'+e+'"]');t?(console.log("found element",t),t.pause(),this.LoadedAudios[e]?.pause()):this.LoadedAudios[e]?.pause()}async loadAndPlayAudio(e,t=!1,i=1){let r=document.querySelector('audio[data-topic-id="'+e+'"]');if(r)r.volume=i,await r.play();else{const n=document.createElement("audio");n.volume=i,t&&n.setAttribute("autoplay","autoplay"),n.setAttribute("data-topic-id",e),n.setAttribute("data-src","hcs://1/"+e),document.body.appendChild(n),await this.loadMedia(n,"audio"),r=document.querySelector('audio[data-topic-id="'+e+'"]'),t||await r.play()}}}var HCS6Operation=(e=>(e.REGISTER="register",e))(HCS6Operation||{}),HCS6RegistryType=(e=>(e[e.NON_INDEXED=1]="NON_INDEXED",e))(HCS6RegistryType||{});function buildHcs6Hrl(e){return`hcs://6/${e}`}const hcs6TopicIdSchema$2=zod.z.string().regex(/^\d+\.\d+\.\d+$/,{message:"Topic ID must be in Hedera format (e.g., '0.0.123456')"}),hcs6BaseMessageSchema$2=zod.z.object({p:zod.z.literal("hcs-6"),op:zod.z.enum(["register"]),m:zod.z.string().max(500,"Memo must not exceed 500 characters").optional()}),hcs6RegisterMessageSchema$2=hcs6BaseMessageSchema$2.extend({op:zod.z.literal("register"),t_id:hcs6TopicIdSchema$2}),hcs6MessageSchema=zod.z.discriminatedUnion("op",[hcs6RegisterMessageSchema$2]);function validateHCS6TTL(e){return e>=3600}function validateHCS6RegistryMemo(e){const t=e.match(/^hcs-6:(\d):(\d+)$/);if(!t)return!1;const i=parseInt(t[1]),r=parseInt(t[2]);return 1===i&&validateHCS6TTL(r)}function generateHCS6RegistryMemo(e){if(!validateHCS6TTL(e))throw new Error("TTL must be at least 3600 seconds (1 hour)");return`hcs-6:1:${e}`}let HederaMirrorNode$3=class{constructor(e,t,i){this.maxRetries=5,this.initialDelayMs=2e3,this.maxDelayMs=3e4,this.backoffFactor=2,this.network=e,this.apiKey=i?.apiKey,this.customHeaders=i?.headers||{},this.baseUrl=i?.customUrl||this.getMirrorNodeUrl(),this.logger=t||new Logger$e({level:"debug",module:"MirrorNode"}),this.isServerEnvironment="undefined"==typeof window,i?.customUrl&&this.logger.info(`Using custom mirror node URL: ${i.customUrl}`),i?.apiKey&&this.logger.info("Using API key for mirror node requests")}configureRetry(e){this.maxRetries=e.maxRetries??this.maxRetries,this.initialDelayMs=e.initialDelayMs??this.initialDelayMs,this.maxDelayMs=e.maxDelayMs??this.maxDelayMs,this.backoffFactor=e.backoffFactor??this.backoffFactor,this.logger.info(`Retry configuration updated: maxRetries=${this.maxRetries}, initialDelayMs=${this.initialDelayMs}, maxDelayMs=${this.maxDelayMs}, backoffFactor=${this.backoffFactor}`)}configureMirrorNode(e){e.customUrl&&(this.baseUrl=e.customUrl,this.logger.info(`Updated mirror node URL: ${e.customUrl}`)),e.apiKey&&(this.apiKey=e.apiKey,this.logger.info("Updated API key for mirror node requests")),e.headers&&(this.customHeaders={...this.customHeaders,...e.headers},this.logger.info("Updated custom headers for mirror node requests"))}constructUrl(e){if(this.baseUrl.includes("<API-KEY>")&&this.apiKey){const t=this.baseUrl.replace("<API-KEY>",this.apiKey);return e.startsWith("/")?`${t}${e}`:`${t}/${e}`}return e.startsWith("/")?`${this.baseUrl}${e}`:`${this.baseUrl}/${e}`}getMirrorNodeUrl(){return"mainnet"===this.network?"https://mainnet-public.mirrornode.hedera.com":"https://testnet.mirrornode.hedera.com"}getBaseUrl(){return this.baseUrl}async getPublicKey(e){this.logger.debug(`Getting public key for account ${e}`);const t=await this.requestAccount(e);try{if(!t||!t.key)throw new Error(`Failed to retrieve public key for account ID: ${e}`);return sdk.PublicKey.fromString(t.key.key)}catch(i){const e=`Error fetching public key from Mirror Node: ${i.message}`;throw this.logger.error(e),new Error(e)}}async getAccountMemo(e){this.logger.debug(`Getting account memo for account ID: ${e}`);try{const t=await this._requestWithRetry(`/api/v1/accounts/${e}`);return t?.memo?t.memo:(this.logger.warn(`No memo found for account ${e}`),null)}catch(t){const i=t;return this.logger.error(`Failed to get account memo for ${e} after retries: ${i.message}`),null}}async getTopicInfo(e){try{this.logger.debug(`Fetching topic info for ${e}`);return await this._requestWithRetry(`/api/v1/topics/${e}`)}catch(t){const i=`Error retrieving topic information for ${e} after retries: ${t.message}`;throw this.logger.error(i),new Error(i)}}async getTopicFees(e){try{return(await this.getTopicInfo(e)).custom_fees}catch(t){const e=`Error retrieving topic fees: ${t.message}`;return this.logger.error(e),null}}async getHBARPrice(e){try{const t=sdk.Timestamp.fromDate(e).toString();this.logger.debug(`Fetching HBAR price for timestamp ${t}`);const i=await this._requestWithRetry(`/api/v1/network/exchangerate?timestamp=${t}`);return Number(i?.current_rate?.cent_equivalent)/Number(i?.current_rate?.hbar_equivalent)/100}catch(t){const e=`Error retrieving HBAR price: ${t.message}`;return this.logger.error(e),null}}async getTokenInfo(e){this.logger.debug(`Fetching token info for ${e}`);try{const t=await this._requestWithRetry(`/api/v1/tokens/${e}`);return t?(this.logger.trace(`Token info found for ${e}:`,t),t):(this.logger.warn(`No token info found for ${e}`),null)}catch(t){const i=`Error fetching token info for ${e}: ${t.message}`;return this.logger.error(i),null}}async getTopicMessages(e,t){this.logger.trace(`Querying messages for topic ${e}${t?" with filters":""}`);let i=`/api/v1/topics/${e}/messages`;const r=new URLSearchParams;if(t){if(void 0!==t.sequenceNumber){const e="number"==typeof t.sequenceNumber?t.sequenceNumber.toString():t.sequenceNumber;e.match(/^(gt|gte|lt|lte|eq|ne):/)?r.append("sequencenumber",e):r.append("sequencenumber",`gt:${e}`)}t.limit&&r.append("limit",t.limit.toString()),t.order&&r.append("order",t.order)}const n=r.toString();n&&(i+=`?${n}`);const o=[];let a=i;for(;a;)try{const e=await this._requestWithRetry(a);if(e.messages&&e.messages.length>0)for(const t of e.messages)try{if(!t.message)continue;let e,i;try{e=this.isServerEnvironment?globalThis.Buffer.from(t.message,"base64").toString("utf-8"):(new TextDecoder).decode(Uint8Array.from(atob(t.message),e=>e.charCodeAt(0)))}catch(s){const e=`Error decoding message: ${s}`;this.logger.error(e);continue}try{i=JSON.parse(e)}catch(s){const t=`Invalid JSON message content: ${e}`;this.logger.error(t);continue}i.sequence_number=t.sequence_number,o.push({...i,consensus_timestamp:t.consensus_timestamp,sequence_number:t.sequence_number,running_hash:t.running_hash,running_hash_version:t.running_hash_version,topic_id:t.topic_id,payer:t.payer_account_id,created:new Date(1e3*Number(t.consensus_timestamp))})}catch(s){const e=`Error processing message: ${s.message}`;this.logger.error(e)}a=e.links?.next||""}catch(c){const t=`Error querying topic messages for topic ${e} (endpoint: ${a}) after retries: ${c.message}`;throw this.logger.error(t),new Error(t)}return o}async requestAccount(e){try{this.logger.debug(`Requesting account info for ${e}`);const t=await this._requestWithRetry(`/api/v1/accounts/${e}`);if(!t)throw new Error(`No data received from mirror node for account: ${e}`);return t}catch(t){const i=`Failed to fetch account ${e} after retries: ${t.message}`;throw this.logger.error(i),new Error(i)}}async checkKeyListAccess(e,t){try{const i=proto.proto.Key.decode(e);return this.evaluateKeyAccess(i,t)}catch(i){const e=`Error decoding protobuf key: ${i.message}`;throw this.logger.error(e),new Error(e)}}async evaluateKeyAccess(e,t){return e.ed25519?this.compareEd25519Key(e.ed25519,t):e.keyList?this.evaluateKeyList(e.keyList,t):!(!e.thresholdKey||!e.thresholdKey.keys)&&this.evaluateKeyList(e.thresholdKey.keys,t)}async evaluateKeyList(e,t){const i=e.keys||[];for(const n of i)if(n)if(n.ed25519){if(this.compareEd25519Key(n.ed25519,t))return!0}else if(n.keyList||n.thresholdKey)try{const e=proto.proto.Key.encode({...n.keyList?{keyList:n.keyList}:{},...n.thresholdKey?{thresholdKey:n.thresholdKey}:{}}).finish();if(await this.checkKeyListAccess(globalThis.Buffer.from(e),t))return!0}catch(r){const e=`Error in nested key: ${r.message}`;this.logger.debug(e)}return!1}compareEd25519Key(e,t){try{return sdk.PublicKey.fromBytes(globalThis.Buffer.from(e)).toString()===t.toString()}catch(i){const e=`Error comparing Ed25519 key: ${i.message}`;return this.logger.debug(e),!1}}async getScheduleInfo(e){try{this.logger.info(`Getting information for scheduled transaction ${e}`);const t=await this._requestWithRetry(`/api/v1/schedules/${e}`);return t||(this.logger.warn(`No schedule info found for ${e} after retries.`),null)}catch(t){return this.logger.error(`Error fetching schedule info for ${e} after retries: ${t.message}`),null}}async getScheduledTransactionStatus(e){try{this.logger.info(`Checking status of scheduled transaction ${e}`);const t=await this.getScheduleInfo(e);if(!t)throw new Error(`Schedule ${e} not found`);return{executed:Boolean(t.executed_timestamp),executedDate:t.executed_timestamp?new Date(1e3*Number(t.executed_timestamp)):void 0,deleted:t.deleted||!1}}catch(t){throw this.logger.error(`Error checking scheduled transaction status: ${t}`),t}}async getTransaction(e){this.logger.info(`Getting transaction details for ID/hash: ${e}`);try{const t=await this._requestWithRetry(`/api/v1/transactions/${e}`);return t?.transactions?.length>0?(this.logger.trace(`Transaction details found for ${e}:`,t.transactions[0]),t.transactions[0]):(this.logger.warn(`No transaction details found for ${e} or unexpected response structure.`),null)}catch(t){const i=t;return this.logger.error(`Failed to get transaction details for ${e} after retries: ${i.message}`),null}}async _requestWithRetry(e,t){let i=0,r=this.initialDelayMs;const n=this.constructUrl(e),o={...t,headers:{...this.customHeaders,...t?.headers}};for(this.apiKey&&(o.headers={...o.headers,Authorization:`Bearer ${this.apiKey}`,"X-API-Key":this.apiKey});i<this.maxRetries;)try{return(await axios$9.get(n,o)).data}catch(a){i++;const e=i>=this.maxRetries,t=a.response?.status;if(t&&t>404&&t<500&&429!==t)throw this.logger.error(`Client error for ${n} (status ${t}): ${a.message}. Not retrying.`),a;if(e)throw this.logger.error(`Max retries (${this.maxRetries}) reached for ${n}. Last error: ${a.message}`),a;this.logger.warn(`Attempt ${i}/${this.maxRetries} failed for ${n}: ${a.message}. Retrying in ${r}ms...`),await new Promise(e=>setTimeout(e,r)),r=Math.min(r*this.backoffFactor,this.maxDelayMs)}throw new Error(`Failed to fetch data from ${n} after ${this.maxRetries} attempts.`)}async _fetchWithRetry(e,t){let i=0,r=this.initialDelayMs;const n={...this.customHeaders};t?.headers&&(t.headers instanceof Headers?t.headers.forEach((e,t)=>{n[t]=e}):Array.isArray(t.headers)?t.headers.forEach(([e,t])=>{n[e]=t}):Object.assign(n,t.headers)),this.apiKey&&(n.Authorization=`Bearer ${this.apiKey}`,n["X-API-Key"]=this.apiKey);const o={...t,headers:n};for(;i<this.maxRetries;)try{const t=await fetch(e,o);if(!t.ok){if(t.status>=400&&t.status<500&&429!==t.status)throw this.logger.error(`Client error for ${e} (status ${t.status}): ${t.statusText}. Not retrying.`),new Error(`Fetch failed with status ${t.status}: ${t.statusText} for URL: ${e}`);throw new Error(`Fetch failed with status ${t.status}: ${t.statusText} for URL: ${e}`)}return await t.json()}catch(a){if(i++,i>=this.maxRetries)throw this.logger.error(`Max retries (${this.maxRetries}) reached for ${e}. Last error: ${a.message}`),a;this.logger.warn(`Attempt ${i}/${this.maxRetries} failed for ${e}: ${a.message}. Retrying in ${r}ms...`),await new Promise(e=>setTimeout(e,r)),r=Math.min(r*this.backoffFactor,this.maxDelayMs)}throw new Error(`Failed to fetch data from ${e} after ${this.maxRetries} attempts.`)}async getAccountBalance(e){this.logger.info(`Getting balance for account ${e}`);try{const t=await this.requestAccount(e);if(t&&t.balance){return t.balance.balance/1e8}return this.logger.warn(`Could not retrieve balance for account ${e} from account info.`),null}catch(t){return this.logger.error(`Error fetching numerical balance for account ${e}: ${t.message}`),null}}async getTopicMessagesByFilter(e,t){this.logger.trace(`Querying messages for topic ${e} with filters: ${JSON.stringify(t)}`);let i=`/api/v1/topics/${e}/messages`;const r=new URLSearchParams;t?.limit&&r.append("limit",t.limit.toString()),t?.sequenceNumber&&r.append("sequencenumber",t.sequenceNumber),t?.startTime&&r.append("timestamp",`gte:${t.startTime}`),t?.endTime&&r.append("timestamp",`lt:${t.endTime}`),t?.order&&r.append("order",t.order);const n=r.toString();n&&(i+=`?${n}`);const o=[];let a=0;try{for(;i&&a<10;){a++;const e=await this._requestWithRetry(i);if(e.messages&&e.messages.length>0)for(const t of e.messages)try{if(!t.message)continue;let e;e=this.isServerEnvironment?globalThis.Buffer.from(t.message,"base64").toString("utf-8"):(new TextDecoder).decode(Uint8Array.from(atob(t.message),e=>e.charCodeAt(0)));let i={};try{i=JSON.parse(e)}catch(s){this.logger.debug(`Message content is not valid JSON, using raw: ${e}`),i={raw_content:e}}const r={...i,consensus_timestamp:t.consensus_timestamp,sequence_number:t.sequence_number,payer_account_id:t.payer_account_id,topic_id:t.topic_id,running_hash:t.running_hash,running_hash_version:t.running_hash_version,chunk_info:t.chunk_info,created:new Date(1e3*Number(t.consensus_timestamp.split(".")[0])+Number(t.consensus_timestamp.split(".")[1]||0)/1e6),payer:t.payer_account_id};o.push(r)}catch(c){this.logger.error(`Error processing individual message: ${c.message}`)}if(t?.limit&&o.length>=t.limit)break;i=e.links?.next?`${e.links.next}`:""}return o}catch(u){const t=u;return this.logger.error(`Error querying filtered topic messages for ${e}: ${t.message}`),null}}async getAccountTokens(e,t=100){this.logger.info(`Getting tokens for account ${e}`);let i=[],r=`/api/v1/accounts/${e}/tokens?limit=${t}`;try{for(let e=0;e<10&&r;e++){const e=await this._requestWithRetry(r);if(e&&e.tokens&&(i=i.concat(e.tokens)),r=e.links?.next||"",!r||t&&i.length>=t){t&&i.length>t&&(i=i.slice(0,t));break}}return i}catch(n){return this.logger.error(`Error fetching tokens for account ${e}: ${n.message}`),null}}async getTransactionByTimestamp(e){this.logger.info(`Getting transaction by timestamp: ${e}`);try{return(await this._requestWithRetry(`/api/v1/transactions?timestamp=${e}&limit=1`)).transactions}catch(t){return this.logger.error(`Error fetching transaction by timestamp ${e}: ${t}`),[]}}async getAccountNfts(e,t,i=100){this.logger.info(`Getting NFTs for account ${e}${t?` for token ${t}`:""}`);let r=[],n=`/api/v1/accounts/${e}/nfts?limit=${i}`;t&&(n+=`&token.id=${t}`);try{for(let e=0;e<10&&n;e++){const e=await this._requestWithRetry(n);if(e&&e.nfts){const t=e.nfts.map(e=>{let t;if(e.metadata)try{t=this.isServerEnvironment?globalThis.Buffer.from(e.metadata,"base64").toString("utf-8"):(new TextDecoder).decode(Uint8Array.from(atob(e.metadata),e=>e.charCodeAt(0)))}catch(i){this.logger.warn(`Failed to decode metadata for NFT ${e.token_id} SN ${e.serial_number}: ${i.message}`)}return{...e,token_uri:t}});r=r.concat(t)}if(n=e.links?.next||"",!n)break}return r}catch(o){return this.logger.error(`Error fetching NFTs for account ${e}: ${o.message}`),null}}async validateNFTOwnership(e,t,i){this.logger.info(`Validating ownership of NFT ${t} SN ${i} for account ${e}`);try{const r=await this.getAccountNfts(e,t);if(r){return r.find(e=>e.token_id===t&&e.serial_number===i)||null}return null}catch(r){return this.logger.error(`Error validating NFT ownership: ${r.message}`),null}}async readSmartContractQuery(e,t,i,r){this.logger.info(`Reading smart contract ${e} with selector ${t}`);const n=e.startsWith("0x")?e:`0x${sdk.AccountId.fromString(e).toSolidityAddress()}`,o=i.startsWith("0x")?i:`0x${sdk.AccountId.fromString(i).toSolidityAddress()}`,a={block:r?.block||"latest",data:t,estimate:r?.estimate||!1,from:o,to:n,gas:r?.gas,gasPrice:r?.gasPrice,value:r?.value||0};Object.keys(a).forEach(e=>{const t=e;void 0===a[t]&&delete a[t]});try{const e=this.constructUrl("/api/v1/contracts/call");return await this._fetchWithRetry(e,{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}})}catch(s){return this.logger.error(`Error reading smart contract ${e}: ${s.message}`),null}}async getOutstandingTokenAirdrops(e,t){this.logger.info(`Getting outstanding token airdrops sent by account ${e}`);let i=`/api/v1/accounts/${e}/airdrops/outstanding`;const r=new URLSearchParams;t?.limit&&r.append("limit",t.limit.toString()),t?.order&&r.append("order",t.order),t?.receiverId&&r.append("receiver.id",t.receiverId),t?.serialNumber&&r.append("serialnumber",t.serialNumber),t?.tokenId&&r.append("token.id",t.tokenId);const n=r.toString();n&&(i+=`?${n}`);try{return(await this._requestWithRetry(i)).airdrops||[]}catch(o){return this.logger.error(`Error fetching outstanding token airdrops for account ${e}: ${o.message}`),null}}async getPendingTokenAirdrops(e,t){this.logger.info(`Getting pending token airdrops received by account ${e}`);let i=`/api/v1/accounts/${e}/airdrops/pending`;const r=new URLSearchParams;t?.limit&&r.append("limit",t.limit.toString()),t?.order&&r.append("order",t.order),t?.senderId&&r.append("sender.id",t.senderId),t?.serialNumber&&r.append("serialnumber",t.serialNumber),t?.tokenId&&r.append("token.id",t.tokenId);const n=r.toString();n&&(i+=`?${n}`);try{return(await this._requestWithRetry(i)).airdrops||[]}catch(o){return this.logger.error(`Error fetching pending token airdrops for account ${e}: ${o.message}`),null}}async getBlocks(e){this.logger.info("Getting blocks from the network");let t="/api/v1/blocks";const i=new URLSearchParams;e?.limit&&i.append("limit",e.limit.toString()),e?.order&&i.append("order",e.order),e?.timestamp&&i.append("timestamp",e.timestamp),e?.blockNumber&&i.append("block.number",e.blockNumber);const r=i.toString();r&&(t+=`?${r}`);try{return(await this._requestWithRetry(t)).blocks||[]}catch(n){return this.logger.error(`Error fetching blocks: ${n.message}`),null}}async getBlock(e){this.logger.info(`Getting block ${e}`);try{return await this._requestWithRetry(`/api/v1/blocks/${e}`)}catch(t){return this.logger.error(`Error fetching block ${e}: ${t.message}`),null}}async getContracts(e){this.logger.info("Getting contracts from the network");let t="/api/v1/contracts";const i=new URLSearchParams;e?.contractId&&i.append("contract.id",e.contractId),e?.limit&&i.append("limit",e.limit.toString()),e?.order&&i.append("order",e.order);const r=i.toString();r&&(t+=`?${r}`);try{return(await this._requestWithRetry(t)).contracts||[]}catch(n){return this.logger.error(`Error fetching contracts: ${n.message}`),null}}async getContract(e,t){this.logger.info(`Getting contract ${e}`);let i=`/api/v1/contracts/${e}`;t&&(i+=`?timestamp=${t}`);try{return await this._requestWithRetry(i)}catch(r){return this.logger.error(`Error fetching contract ${e}: ${r.message}`),null}}async getContractResults(e){this.logger.info("Getting contract results from the network");let t="/api/v1/contracts/results";const i=new URLSearchParams;e?.from&&i.append("from",e.from),e?.blockHash&&i.append("block.hash",e.blockHash),e?.blockNumber&&i.append("block.number",e.blockNumber),void 0!==e?.internal&&i.append("internal",e.internal.toString()),e?.limit&&i.append("limit",e.limit.toString()),e?.order&&i.append("order",e.order),e?.timestamp&&i.append("timestamp",e.timestamp),e?.transactionIndex&&i.append("transaction.index",e.transactionIndex.toString());const r=i.toString();r&&(t+=`?${r}`);try{return(await this._requestWithRetry(t)).results||[]}catch(n){return this.logger.error(`Error fetching contract results: ${n.message}`),null}}async getContractResult(e,t){this.logger.info(`Getting contract result for ${e}`);let i=`/api/v1/contracts/results/${e}`;void 0!==t&&(i+=`?nonce=${t}`);try{return await this._requestWithRetry(i)}catch(r){return this.logger.error(`Error fetching contract result for ${e}: ${r.message}`),null}}async getContractResultsByContract(e,t){this.logger.info(`Getting contract results for contract ${e}`);let i=`/api/v1/contracts/${e}/results`;const r=new URLSearchParams;t?.blockHash&&r.append("block.hash",t.blockHash),t?.blockNumber&&r.append("block.number",t.blockNumber),t?.from&&r.append("from",t.from),void 0!==t?.internal&&r.append("internal",t.internal.toString()),t?.limit&&r.append("limit",t.limit.toString()),t?.order&&r.append("order",t.order),t?.timestamp&&r.append("timestamp",t.timestamp),t?.transactionIndex&&r.append("transaction.index",t.transactionIndex.toString());const n=r.toString();n&&(i+=`?${n}`);try{return(await this._requestWithRetry(i)).results||[]}catch(o){return this.logger.error(`Error fetching contract results for ${e}: ${o.message}`),null}}async getContractState(e,t){this.logger.info(`Getting contract state for ${e}`);let i=`/api/v1/contracts/${e}/state`;const r=new URLSearchParams;t?.limit&&r.append("limit",t.limit.toString()),t?.order&&r.append("order",t.order),t?.slot&&r.append("slot",t.slot),t?.timestamp&&r.append("timestamp",t.timestamp);const n=r.toString();n&&(i+=`?${n}`);try{return(await this._requestWithRetry(i)).state||[]}catch(o){return this.logger.error(`Error fetching contract state for ${e}: ${o.message}`),null}}async getContractActions(e,t){this.logger.info(`Getting contract actions for ${e}`);let i=`/api/v1/contracts/results/${e}/actions`;const r=new URLSearchParams;t?.index&&r.append("index",t.index),t?.limit&&r.append("limit",t.limit.toString()),t?.order&&r.append("order",t.order);const n=r.toString();n&&(i+=`?${n}`);try{return(await this._requestWithRetry(i)).actions||[]}catch(o){return this.logger.error(`Error fetching contract actions for ${e}: ${o.message}`),null}}async getContractLogs(e){this.logger.info("Getting contract logs from the network");let t="/api/v1/contracts/results/logs";const i=new URLSearchParams;e?.index&&i.append("index",e.index),e?.limit&&i.append("limit",e.limit.toString()),e?.order&&i.append("order",e.order),e?.timestamp&&i.append("timestamp",e.timestamp),e?.topic0&&i.append("topic0",e.topic0),e?.topic1&&i.append("topic1",e.topic1),e?.topic2&&i.append("topic2",e.topic2),e?.topic3&&i.append("topic3",e.topic3),e?.transactionHash&&i.append("transaction.hash",e.transactionHash);const r=i.toString();r&&(t+=`?${r}`);try{return(await this._requestWithRetry(t)).logs||[]}catch(n){return this.logger.error(`Error fetching contract logs: ${n.message}`),null}}async getContractLogsByContract(e,t){this.logger.info(`Getting contract logs for contract ${e}`);let i=`/api/v1/contracts/${e}/results/logs`;const r=new URLSearchParams;t?.index&&r.append("index",t.index),t?.limit&&r.append("limit",t.limit.toString()),t?.order&&r.append("order",t.order),t?.timestamp&&r.append("timestamp",t.timestamp),t?.topic0&&r.append("topic0",t.topic0),t?.topic1&&r.append("topic1",t.topic1),t?.topic2&&r.append("topic2",t.topic2),t?.topic3&&r.append("topic3",t.topic3);const n=r.toString();n&&(i+=`?${n}`);try{return(await this._requestWithRetry(i)).logs||[]}catch(o){return this.logger.error(`Error fetching contract logs for ${e}: ${o.message}`),null}}async getNftInfo(e,t){this.logger.info(`Getting NFT info for ${e}/${t}`);const i=`/api/v1/tokens/${e}/nfts/${t}`;try{return await this._requestWithRetry(i)}catch(r){return this.logger.error(`Error fetching NFT info for ${e}/${t}: ${r.message}`),null}}async getNftsByToken(e,t){this.logger.info(`Getting NFTs for token ${e}`);let i=`/api/v1/tokens/${e}/nfts`;const r=new URLSearchParams;t?.accountId&&r.append("account.id",t.accountId),t?.limit&&r.append("limit",t.limit.toString()),t?.order&&r.append("order",t.order),t?.serialNumber&&r.append("serialnumber",t.serialNumber);const n=r.toString();n&&(i+=`?${n}`);try{return(await this._requestWithRetry(i)).nfts||[]}catch(o){return this.logger.error(`Error fetching NFTs for token ${e}: ${o.message}`),null}}async getNetworkInfo(){this.logger.info("Getting network information");try{return await this._requestWithRetry("/api/v1/network/nodes")}catch(e){return this.logger.error(`Error fetching network info: ${e.message}`),null}}async getNetworkFees(e){this.logger.info("Getting network fees");let t="/api/v1/network/fees";e&&(t+=`?timestamp=${e}`);try{return await this._requestWithRetry(t)}catch(i){return this.logger.error(`Error fetching network fees: ${i.message}`),null}}async getNetworkSupply(e){this.logger.info("Getting network supply");let t="/api/v1/network/supply";e&&(t+=`?timestamp=${e}`);try{return await this._requestWithRetry(t)}catch(i){return this.logger.error(`Error fetching network supply: ${i.message}`),null}}async getNetworkStake(e){this.logger.info("Getting network stake");let t="/api/v1/network/stake";e&&(t+=`?timestamp=${e}`);try{return await this._requestWithRetry(t)}catch(i){return this.logger.error(`Error fetching network stake: ${i.message}`),null}}async getOpcodeTraces(e,t){this.logger.info(`Getting opcode traces for ${e}`);let i=`/api/v1/contracts/results/${e}/opcodes`;const r=new URLSearchParams;void 0!==t?.stack&&r.append("stack",t.stack.toString()),void 0!==t?.memory&&r.append("memory",t.memory.toString()),void 0!==t?.storage&&r.append("storage",t.storage.toString());const n=r.toString();n&&(i+=`?${n}`);try{return await this._requestWithRetry(i)}catch(o){return this.logger.error(`Error fetching opcode traces for ${e}: ${o.message}`),null}}};class HCS6BaseClient{constructor(e){this.network=e.network,this.logger=e.logger||Logger$e.getInstance({level:e.logLevel||"info",module:"HCS6Client",silent:e.silent}),this.mirrorNode=new HederaMirrorNode$3(this.network,this.logger,e.mirrorNodeUrl?{customUrl:e.mirrorNodeUrl}:void 0)}parseRegistryTypeFromMemo(e){try{const t=/hcs-6:(\d):(\d+)/,i=e.match(t);if(i&&3===i.length){const e=parseInt(i[1]),t=parseInt(i[2]);if(e===HCS6RegistryType.NON_INDEXED&&validateHCS6TTL(t))return{registryType:e,ttl:t}}return}catch(t){return void this.logger.error(`Error parsing HCS-6 registry type from memo: ${t}`)}}generateRegistryMemo(e){return generateHCS6RegistryMemo(e)}validateMessage(e){try{return hcs6MessageSchema.parse(e),{valid:!0,errors:[]}}catch(t){const e=[];return t instanceof zod.ZodError?t.errors.forEach(t=>{const i=t.path.join(".");e.push(`${i?i+": ":""}${t.message}`)}):e.push(`Unexpected error: ${t}`),this.logger.debug(`HCS-6 message validation failed: ${e.join(", ")}`),{valid:!1,errors:e}}}createRegisterMessage(e,t){return{p:"hcs-6",op:HCS6Operation.REGISTER,t_id:e,m:t}}parseRegistryEntries(e,t,i,r){const n=[];let o;this.logger.debug(`Parsing ${t.length} messages for HCS-6 topic ${e}`);for(const s of t)try{if(!s.message){this.logger.debug(`Message is missing 'message' property: ${JSON.stringify(s)}`);continue}const t=globalThis.Buffer.from(s.message,"base64").toString("utf-8"),r=JSON.parse(t);this.logger.debug(`Successfully parsed HCS-6 message: ${JSON.stringify(r)}`);const{valid:a,errors:c}=this.validateMessage(r);if(!a){this.logger.warn(`Invalid HCS-6 message: ${c.join(", ")}`);continue}const u={topicId:e,sequence:s.sequence_number,timestamp:s.consensus_timestamp,payer:s.payer_account_id,message:r,consensus_timestamp:s.consensus_timestamp,registry_type:i};n.push(u),(!o||u.timestamp>o.timestamp)&&(o=u)}catch(a){this.logger.warn(`Error parsing HCS-6 message: ${a}`)}return this.logger.debug(`Parsed ${n.length} valid entries for HCS-6 topic ${e}`),{topicId:e,registryType:i,ttl:r,entries:o?[o]:[],latestEntry:o}}async validateHCS6Topic(e){try{const t=await this.mirrorNode.getTopicInfo(e),i=this.parseRegistryTypeFromMemo(t.memo);return i?i.registryType===HCS6RegistryType.NON_INDEXED||(this.logger.warn(`Topic ${e} is not a valid HCS-6 registry (must be non-indexed)`),!1):(this.logger.warn(`Topic ${e} is not a valid HCS-6 registry (invalid memo format)`),!1)}catch(t){return this.logger.error(`Error validating HCS-6 topic ${e}: ${t}`),!1}}}function encodeHcs2RegistryMemo(e,t){return`hcs-2:${e}:${t}`}function buildTopicCreateTx(e){const{memo:t,adminKey:i,submitKey:r,operatorPublicKey:n}=e,o=(new sdk.TopicCreateTransaction).setTopicMemo(t),a=e=>{if(e){if(e instanceof sdk.PublicKey||e instanceof sdk.KeyList)return e;if("boolean"==typeof e)return e?n:void 0;if("string"==typeof e)try{return sdk.PublicKey.fromString(e)}catch{return}}},s=a(i);s&&o.setAdminKey(s);const c=a(r);return c&&o.setSubmitKey(c),o}function buildMessageTx(e){const t=(new sdk.TopicMessageSubmitTransaction).setTopicId(sdk.TopicId.fromString(e.topicId)).setMessage(e.message);return e.transactionMemo&&t.setTransactionMemo(e.transactionMemo),t}function encodeHcs6NonIndexedMemo(e){return`hcs-6:1:${e}`}function buildHcs6CreateRegistryTx(e){return buildTopicCreateTx({memo:e.memoOverride??encodeHcs6NonIndexedMemo(e.ttl),submitKey:e.submitKey,adminKey:e.adminKey,operatorPublicKey:e.operatorPublicKey})}function buildHcs6RegisterEntryTx(e){const t={p:"hcs-6",op:HCS6Operation.REGISTER,t_id:e.targetTopicId,m:e.memo};return buildMessageTx({topicId:e.registryTopicId,message:JSON.stringify(t),transactionMemo:e.analyticsMemo})}var KeyType=(e=>(e.ED25519="ed25519",e.ECDSA="ecdsa",e.UNKNOWN="unknown",e))(KeyType||{});let KeyTypeDetector$4=(_b2=class{static detect(e){try{let t,i="raw";if("string"==typeof e){let r=e.trim();if(r.includes("-----BEGIN"))return this.detectFromPem(r);if(r.toLowerCase().startsWith("0x")&&(r=r.substring(2)),this.isValidHex(r))t=this.hexToBytes(r),i="hex";else{if(!this.isBase64(r))return{type:"unknown",format:"raw",isPrivateKey:!1,confidence:"certain"};t=globalThis.Buffer.from(r,"base64"),i="der"}}else t=e instanceof globalThis.Buffer?new Uint8Array(e):e;return this.detectFromBytes(t,i)}catch(t){return{type:"unknown",format:"raw",isPrivateKey:!1,confidence:"certain"}}}static detectFromBytes(e,t){if(this.hasPrefix(e,this.ED25519_PUBLIC_KEY_PREFIX)){const t=this.ED25519_PUBLIC_KEY_PREFIX.length;return{type:"ed25519",format:"der",isPrivateKey:!1,rawBytes:e.slice(t),confidence:"certain"}}if(this.hasPrefix(e,this.ED25519_PRIVATE_KEY_PREFIX)){const t=this.ED25519_PRIVATE_KEY_PREFIX.length;if(e.length>=t+32)return{type:"ed25519",format:"der",isPrivateKey:!0,rawBytes:e.slice(t,t+32),confidence:"certain"}}if(this.hasPrefix(e,this.ECDSA_SECP256K1_PUBLIC_KEY_PREFIX)){const t=this.ECDSA_SECP256K1_PUBLIC_KEY_PREFIX.length;return{type:"ecdsa",format:"der",isPrivateKey:!1,rawBytes:e.slice(t),confidence:"certain"}}if(this.hasPrefix(e,this.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX_SHORT)){const t=this.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX_SHORT.length;return{type:"ecdsa",format:"der",isPrivateKey:!0,rawBytes:e.slice(t),confidence:"certain"}}if(this.hasPrefix(e,this.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX)){const t=this.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX.length;return{type:"ecdsa",format:"der",isPrivateKey:!0,rawBytes:e.slice(t,t+32),confidence:"certain"}}if(this.hasPrefix(e,this.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX_LONG)){const t=this.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX_LONG.length;return{type:"ecdsa",format:"der",isPrivateKey:!0,rawBytes:e.slice(t,t+32),confidence:"certain"}}if(e.length>36&&this.containsECDSAPrivateKeyPattern(e))return{type:"ecdsa",format:"der",isPrivateKey:!0,rawBytes:this.extractECDSAPrivateKey(e),confidence:"certain"};switch(e.length){case this.ED25519_PUBLIC_KEY_LENGTH:if("hex"===t){const t=Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join(""),i=this.tryCreateKey(t);if("unknown"!==i.type)return i}return{type:"unknown",format:t,isPrivateKey:!1,rawBytes:e,confidence:"certain"};case this.ED25519_EXPANDED_PRIVATE_KEY_LENGTH:return{type:"ed25519",format:t,isPrivateKey:!0,rawBytes:e,confidence:"certain"}}return{type:"unknown",format:t,isPrivateKey:!1,rawBytes:e,confidence:"certain"}}static detectFromPem(e){const t=e.trim(),i=t.includes("PRIVATE KEY"),r={EC_PRIVATE:/-----BEGIN EC PRIVATE KEY-----/,EC_PUBLIC:/-----BEGIN EC PUBLIC KEY-----/,PRIVATE:/-----BEGIN PRIVATE KEY-----/,PUBLIC:/-----BEGIN PUBLIC KEY-----/};let n=!1;for(const[s,c]of Object.entries(r))if(c.test(t)&&s.includes("EC")){n=!0;break}const o=t.match(/-----BEGIN[\s\S]+?-----[\r\n]+([\s\S]+?)[\r\n]+-----END/);if(!o)return{type:"unknown",format:"pem",isPrivateKey:i,confidence:"certain"};const a=o[1].replace(/\s/g,"");try{const e=globalThis.Buffer.from(a,"base64"),t=this.detectFromBytes(new Uint8Array(e),"der");return"unknown"===t.type&&n?{type:"ecdsa",format:"pem",isPrivateKey:i,rawBytes:e,confidence:"certain"}:{...t,format:"pem"}}catch{return{type:"unknown",format:"pem",isPrivateKey:i,confidence:"certain"}}}static tryCreateKey(e){try{if("string"==typeof e){let t=e.trim();if(t.toLowerCase().startsWith("0x")&&(t=t.substring(2)),this.isValidHex(t)&&64===t.length){const e=this.hexToBytes(t),i=this.detectBySignature(t);return"unknown"!==i.type?{type:i.type,format:"hex",isPrivateKey:!0,rawBytes:e,confidence:i.confidence,warning:i.warning}:{type:"unknown",format:"hex",isPrivateKey:!1,rawBytes:e,confidence:"certain"}}}}catch{}return{type:"unknown",format:"hex",isPrivateKey:!1,rawBytes:new Uint8Array,confidence:"certain"}}static detectBySignature(e){const t=BigInt("0x"+e),i=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141");if(0n===t)return{type:"ed25519",confidence:"certain"};if(t>=i)return{type:"ed25519",confidence:"certain"};let r=!1,n=!1;try{const t=sdk.PrivateKey.fromStringED25519(e),i=new Uint8Array([1,2,3,4,5]),n=t.sign(i);t.publicKey.verify(i,n)&&(r=!0)}catch{}try{const t=sdk.PrivateKey.fromStringECDSA(e),i=new Uint8Array([1,2,3,4,5]),r=t.sign(i);t.publicKey.verify(i,r)&&(n=!0)}catch{}if(r&&n){const t=this.hexToBytes(e);if(168===t[0]&&1===t[1])return{type:"ed25519",confidence:"uncertain",warning:"Detection based on byte pattern heuristic. Both ED25519 and ECDSA accept this key."};let i=0;for(const e of t)e>=128&&i++;const r=i/t.length;return r>=.4&&r<=.6?{type:"ecdsa",confidence:"uncertain",warning:"Detection based on entropy heuristic. Both ED25519 and ECDSA accept this key."}:{type:"ecdsa",confidence:"uncertain",warning:"Detection based on entropy heuristic. Both ED25519 and ECDSA accept this key. Defaulting to ECDSA."}}return r&&!n?{type:"ed25519",confidence:"certain"}:n&&!r?{type:"ecdsa",confidence:"certain"}:{type:"unknown",confidence:"certain"}}static isValidHex(e){return/^[0-9a-fA-F]+$/.test(e)&&e.length%2==0}static isBase64(e){try{return globalThis.Buffer.from(e,"base64").toString("base64")===e}catch{return!1}}static hexToBytes(e){const t=new Uint8Array(e.length/2);for(let i=0;i<e.length;i+=2)t[i/2]=parseInt(e.substr(i,2),16);return t}static hasPrefix(e,t){if(e.length<t.length)return!1;for(let i=0;i<t.length;i++)if(e[i]!==t[i])return!1;return!0}static containsECDSAPrivateKeyPattern(e){for(let t=0;t<e.length-7;t++)if(48===e[t]&&116===e[t+1]&&2===e[t+2]&&1===e[t+3]&&1===e[t+4]&&4===e[t+5]&&32===e[t+6])return!0;return!1}static extractECDSAPrivateKey(e){for(let t=0;t<e.length-32;t++)if(4===e[t]&&32===e[t+1])return e.slice(t+2,t+34);return e}},_b2.ED25519_PUBLIC_KEY_LENGTH=32,_b2.ED25519_EXPANDED_PRIVATE_KEY_LENGTH=64,_b2.ED25519_PUBLIC_KEY_PREFIX=globalThis.Buffer.from([48,42,48,5,6,3,43,101,112,3,33,0]),_b2.ED25519_PRIVATE_KEY_PREFIX=globalThis.Buffer.from([48,46,2,1,0,48,5,6,3,43,101,112,4,34,4,32]),_b2.ECDSA_SECP256K1_PUBLIC_KEY_PREFIX=globalThis.Buffer.from([48,86,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10,3,66,0]),_b2.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX=globalThis.Buffer.from([48,116,2,1,1,4,32]),_b2.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX_SHORT=globalThis.Buffer.from([48,48,2,1,0,48,7,6,5,43,129,4,0,10,4,34,4,32]),_b2.ECDSA_SECP256K1_PRIVATE_KEY_PREFIX_LONG=globalThis.Buffer.from([48,119,2,1,1,4,32]),_b2);function detectKeyTypeFromString$8(e){const t=KeyTypeDetector$4.detect(e);if("unknown"!==t.type)try{const i="ecdsa"===t.type?sdk.PrivateKey.fromStringECDSA(e):sdk.PrivateKey.fromStringED25519(e),r={detectedType:t.type,privateKey:i};return"uncertain"===t.confidence&&(r.warning="Key type detection is uncertain. If you have the associated account ID, consider using the Hedera mirror node to confirm the key type."),r}catch(i){}try{return{detectedType:"ecdsa",privateKey:sdk.PrivateKey.fromStringECDSA(e),warning:"Using ECDSA as default. If you have the associated account ID, consider using the Hedera mirror node to confirm the key type."}}catch(r){try{return{detectedType:"ed25519",privateKey:sdk.PrivateKey.fromStringED25519(e),warning:"Using ED25519 as fallback. If you have the associated account ID, consider using the Hedera mirror node to confirm the key type."}}catch(n){throw new Error(`Failed to parse private key as either ECDSA or ED25519: ${r}`)}}}class NodeOperatorResolver{constructor(e){this.mirror=e.mirrorNode,this.logger=e.logger}bestGuessOperatorKey(e,t){if("string"!=typeof e)return{keyType:t||"ecdsa",privateKey:e};if(t){return{keyType:t,privateKey:"ed25519"===t?sdk.PrivateKey.fromStringED25519(e):sdk.PrivateKey.fromStringECDSA(e)}}try{const t=detectKeyTypeFromString$8(e);return{keyType:t.detectedType,privateKey:t.privateKey}}catch{return{keyType:"ecdsa",privateKey:sdk.PrivateKey.fromStringECDSA(e)}}}async resolveOperatorKey(e,t,i){if("string"!=typeof t)return{keyType:i||"ecdsa",privateKey:t};if(i){return{keyType:i,privateKey:"ed25519"===i?sdk.PrivateKey.fromStringED25519(t):sdk.PrivateKey.fromStringECDSA(t)}}const r="string"==typeof e?e:e.toString();try{const e=await this.mirror.requestAccount(r),i=(e?.key?._type||"").includes("ED25519")?"ed25519":"ecdsa";return{keyType:i,privateKey:"ed25519"===i?sdk.PrivateKey.fromStringED25519(t):sdk.PrivateKey.fromStringECDSA(t)}}catch{return this.logger.warn("Mirror node key detection failed; using local detection or default ECDSA"),this.bestGuessOperatorKey(t)}}async resolveSupplyKey(e,t,i,r){try{const n=await this.mirror.getTokenInfo(e),o=n?.supply_key?._type||"";return"string"!=typeof t?t:r?"ed25519"===r?sdk.PrivateKey.fromStringED25519(t):sdk.PrivateKey.fromStringECDSA(t):o.includes("ED25519")?sdk.PrivateKey.fromStringED25519(t):o.includes("ECDSA")?sdk.PrivateKey.fromStringECDSA(t):"ed25519"===i?sdk.PrivateKey.fromStringED25519(t):sdk.PrivateKey.fromStringECDSA(t)}catch{return"string"!=typeof t?t:r?"ed25519"===r?sdk.PrivateKey.fromStringED25519(t):sdk.PrivateKey.fromStringECDSA(t):"ed25519"===i?sdk.PrivateKey.fromStringED25519(t):sdk.PrivateKey.fromStringECDSA(t)}}}function createNodeOperatorContext(e){const t="string"==typeof e.operatorId?sdk.AccountId.fromString(e.operatorId):e.operatorId,i=e.client?e.client:"mainnet"===e.network?sdk.Client.forMainnet():sdk.Client.forTestnet(),r=new NodeOperatorResolver({mirrorNode:e.mirrorNode,logger:e.logger});let n,o;const a=r.bestGuessOperatorKey(e.operatorKey,e.keyType);n=a.keyType,o=a.privateKey,i.setOperator(t.toString(),o);const s=(async()=>{try{const a=await r.resolveOperatorKey(t,e.operatorKey,e.keyType);n=a.keyType,o=a.privateKey,i.setOperator(t.toString(),o)}catch{}})();return{client:i,operatorId:t,get operatorKey(){return o},get keyType(){return n},ensureInitialized:async()=>{await s}}}var __defProp3=Object.defineProperty,__defNormalProp3=(e,t,i)=>t in e?__defProp3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,__publicField3=(e,t,i)=>__defNormalProp3(e,"symbol"!=typeof t?t+"":t,i),_a4,buffer$9={},base64Js$8={};base64Js$8.byteLength=byteLength$e,base64Js$8.toByteArray=toByteArray$8,base64Js$8.fromByteArray=fromByteArray$8;for(var lookup$e=[],revLookup$8=[],Arr$8="undefined"!=typeof Uint8Array?Uint8Array:Array,code$8="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i$a=0,len$8=code$8.length;i$a<len$8;++i$a)lookup$e[i$a]=code$8[i$a],revLookup$8[code$8.charCodeAt(i$a)]=i$a;function getLens$8(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function byteLength$e(e){var t=getLens$8(e),i=t[0],r=t[1];return 3*(i+r)/4-r}function _byteLength$8(e,t,i){return 3*(t+i)/4-i}function toByteArray$8(e){var t,i,r=getLens$8(e),n=r[0],o=r[1],a=new Arr$8(_byteLength$8(e,n,o)),s=0,c=o>0?n-4:n;for(i=0;i<c;i+=4)t=revLookup$8[e.charCodeAt(i)]<<18|revLookup$8[e.charCodeAt(i+1)]<<12|revLookup$8[e.charCodeAt(i+2)]<<6|revLookup$8[e.charCodeAt(i+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;return 2===o&&(t=revLookup$8[e.charCodeAt(i)]<<2|revLookup$8[e.charCodeAt(i+1)]>>4,a[s++]=255&t),1===o&&(t=revLookup$8[e.charCodeAt(i)]<<10|revLookup$8[e.charCodeAt(i+1)]<<4|revLookup$8[e.charCodeAt(i+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t),a}function tripletToBase64$8(e){return lookup$e[e>>18&63]+lookup$e[e>>12&63]+lookup$e[e>>6&63]+lookup$e[63&e]}function encodeChunk$8(e,t,i){for(var r,n=[],o=t;o<i;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),n.push(tripletToBase64$8(r));return n.join("")}function fromByteArray$8(e){for(var t,i=e.length,r=i%3,n=[],o=16383,a=0,s=i-r;a<s;a+=o)n.push(encodeChunk$8(e,a,a+o>s?s:a+o));return 1===r?(t=e[i-1],n.push(lookup$e[t>>2]+lookup$e[t<<4&63]+"==")):2===r&&(t=(e[i-2]<<8)+e[i-1],n.push(lookup$e[t>>10]+lookup$e[t>>4&63]+lookup$e[t<<2&63]+"=")),n.join("")}revLookup$8["-".charCodeAt(0)]=62,revLookup$8["_".charCodeAt(0)]=63;var ieee754$9={
 /*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
 read:function(e,t,i,r,n){var o,a,s=8*n-r-1,c=(1<<s)-1,u=c>>1,l=-7,p=i?n-1:0,d=i?-1:1,f=e[t+p];for(p+=d,o=f&(1<<-l)-1,f>>=-l,l+=s;l>0;o=256*o+e[t+p],p+=d,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+p],p+=d,l-=8);if(0===o)o=1-u;else{if(o===c)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),o-=u}return(f?-1:1)*a*Math.pow(2,o-r)},write:function(e,t,i,r,n,o){var a,s,c,u=8*o-n-1,l=(1<<u)-1,p=l>>1,d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+p>=1?d/c:d*Math.pow(2,1-p))*c>=2&&(a++,c/=2),a+p>=l?(s=0,a=l):a+p>=1?(s=(t*c-1)*Math.pow(2,n),a+=p):(s=t*Math.pow(2,p-1)*Math.pow(2,n),a=0));n>=8;e[i+f]=255&s,f+=h,s/=256,n-=8);for(a=a<<n|s,u+=n;u>0;e[i+f]=255&a,f+=h,a/=256,u-=8);e[i+f-h]|=128*m}};
 /*!
diff --git a/node_modules/@hashgraphonline/standards-sdk/dist/es/standards-sdk.es2.js b/node_modules/@hashgraphonline/standards-sdk/dist/es/standards-sdk.es2.js
index 922a1d5..5e79814 100644
--- a/node_modules/@hashgraphonline/standards-sdk/dist/es/standards-sdk.es2.js
+++ b/node_modules/@hashgraphonline/standards-sdk/dist/es/standards-sdk.es2.js
@@ -1,5 +1,17 @@
-import { createRequire } from "node:module";
-const require2 = createRequire(import.meta.url);
+const require2 = (() => {
+  try {
+    const req = Function("return typeof require !== 'undefined' ? require : null")();
+    if (req) {
+      const { createRequire } = req("module");
+      return createRequire(import.meta.url);
+    }
+  } catch {
+    // ignore and fall through
+  }
+  return () => {
+    throw new Error("Dynamic require is not supported in this environment.");
+  };
+})();
 const accountModule = safeRequire(
   "@hashgraph/sdk/lib/account/AccountId.cjs"
 );
